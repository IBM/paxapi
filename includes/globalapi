<h1 id='global-api-functions'>Global API functions</h1>
<p>Global API functions can be used to interact with any IBM Planning Analytics for Microsoft Excel worksheets. The global functions that are exposed through the IBM Cognos® automation objects are:</p>
<h2 id='getconnection'>GetConnection</h2>
<p>GetConnection is a method exposed by the top level reporting API object. If you want to use the REST APIs, you&#39;ll need to use the GetConnection method to return the connection object that implements the REST request methods (GET, POST, DELETE, PATCH) and communicate with the TM1 Server.</p>

<p>To learn more about REST request methods, see <a href="#rest-api">REST API</a>.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the GetConnection method. 
To use the method, you must know the URL of the host that you want to send REST requests to.
<code>Reporting.GetConnection(&lt;CURRENT&gt;)</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to send REST requests to.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='changedatasource-task-pane'>ChangeDataSource (Task Pane)</h2>
<p>You can use the ChangeDataSource method to change datasources within a session. You might be prompted for a login if you weren&#39;t logged in. </p>
<h3 id='syntax-2'>Syntax</h3>
<p>Reporting.TaskPane.ChangeDatasource (&quot;host system URL&quot;, &quot;server name&quot;)</p>
<h2 id='clearalldata'>ClearAllData</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">ClearAllData</span> 
</code></pre></div>
<p>ClearAllData clears all data values in the opened workbooks.</p>
<h3 id='syntax-3'>Syntax</h3>
<p>The following string is the syntax for the ClearAllData method.</p>

<p><code>ClearAllData()</code></p>
<h2 id='clearbook'>ClearBook</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">ClearBook</span>
</code></pre></div>
<p>ClearBook clears Planning Analytics for Microsoft Excel data in the active book.</p>
<h3 id='syntax-4'>Syntax</h3>
<p>The following string is the syntax for the ClearBook method.</p>

<p><code>ClearBook()</code></p>
<h2 id='clearcache'>ClearCache</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">ClearCache</span><span class="p">()</span>
</code></pre></div>
<p>ClearCache reduces the size of an IBM® Planning Analytics for Microsoft Excel workbook by clearing metadata and data from formulas.</p>
<h3 id='syntax-5'>Syntax</h3>
<p>The following string is the syntax for the ClearCache method.</p>

<p><code>ClearCache()</code></p>
<h2 id='clearselection'>ClearSelection</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">ClearSelection</span>
</code></pre></div>
<p>ClearSelection clears IBM Planning Analytics for Microsoft Excel data in the active selection.</p>
<h3 id='syntax-6'>Syntax</h3>
<p>The following string is the syntax for the ClearSelection method.</p>

<p><code>ClearSelection()</code></p>
<h2 id='clearsheet'>ClearSheet</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">ClearSheet</span>
</code></pre></div>
<p>ClearSheet clears IBM Planning Analytics for Microsoft Excel data in the active sheet.</p>
<h3 id='syntax-7'>Syntax</h3>
<p>The following string is the syntax for the ClearSheet method.</p>

<p><code>ClearSheet()</code></p>
<h2 id='evaluatesynchronous'>EvaluateSynchronous</h2>
<p>The EvaluateSynchronous function behaves like Excel&#39;s Evaluate formula and turns a string into a formula. For example, you can use EvaluateSynchronous to find the nth child of a parent or to determine the parent of a given dimension element.</p>
<h3 id='syntax-8'>Syntax</h3>
<p>The following string is the syntax for the EvaluateSynchronous method.</p>

<p><code>Reporting.EvaluateSynchronous(evalString)</code></p>
<h3 id='singlepassmode'>SinglePassMode</h3>
<p>To use Excel’s Evaluate formula instead of EvaluateSynchronous, you can toggle single pass mode on and off between evaluations with Reporting.SinglePassMode. </p>

<p>You must set the SinglePassMode flag to false before the Exit Function to avoid any degradation in performance.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">SinglePassMode</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">var</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Evaluate</span><span class="p">(</span><span class="s">"=ELCOMPN(</span><span class="se">""</span><span class="s">"</span> <span class="o">&amp;</span> <span class="n">cube</span> <span class="o">&amp;</span> <span class="s">":"</span> <span class="o">&amp;</span> <span class="n">dimension</span> <span class="o">&amp;</span> <span class="s">"</span><span class="se">""</span><span class="s">,"</span> <span class="o">&amp;</span> <span class="s">"</span><span class="se">""</span><span class="s">"</span> <span class="o">&amp;</span> <span class="n">parent</span> <span class="o">&amp;</span> <span class="s">"</span><span class="se">""</span><span class="s">"</span> <span class="o">&amp;</span> <span class="s">")"</span><span class="p">)</span>
<span class="n">Reporting</span><span class="p">.</span><span class="n">SinglePassMode</span> <span class="o">=</span> <span class="n">false</span>  
<span class="k">Exit</span> <span class="k">Function</span>

</code></pre></div><h4 id='syntax-9'>Syntax</h4>
<p><code>Reporting.SinglePassMode</code></p>
<h2 id='hide-task-pane'>Hide (Task Pane)</h2>
<p>You can use the Hide method to hide the Task Pane.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Hide</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span> 
</code></pre></div><h3 id='syntax-10'>Syntax</h3>
<p>The following is the syntax for the Hide method.</p>

<p><code>Reporting.TaskPane.Hide()</code></p>
<h2 id='httplogoncredentials'>HttpLogonCredentials</h2>
<p>The HttpLogonCredentials function authenticates a user to a Web site that requires new authentication credentials, such as Basic, Kerberos, and SiteMinder. HttpLogonCredentials takes the URL, user name, and password that are used for authentication on the Web site.</p>
<h3 id='syntax-11'>Syntax</h3>
<p>IBM® Cognos® does not support SiteMinder form-based authentication. You must use the IBM Cognos menu commands and options instead of the API to automate the refreshing and publishing of content.</p>

<p><code>HttpLogonCredentials (url, user name, password)</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>The URL for the Web site against which you want to authenticate.</td>
<td>String</td>
</tr>
<tr>
<td>user name</td>
<td>The user name for authentication.</td>
<td>String</td>
</tr>
<tr>
<td>password</td>
<td>The password for authentication.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='isvisible-task-pane'>IsVisible (Task Pane)</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Refresh</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>You can use the IsVisible method to return the state of the Task Pane. If True is returned, the Task Pane is visible. If False is returned, the Task Pane is not visible.</p>
<h3 id='syntax-12'>Syntax</h3>
<p>The following is the syntax for the IsVisible method.</p>

<p><code>Reporting.TaskPane.IsVisible()</code></p>
<h2 id='logoff'>Logoff</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logoff</span>
</code></pre></div>
<p>Logoff logs off all the IBM® Cognos® servers to which users are currently logged on.</p>
<h3 id='syntax-13'>Syntax</h3>
<p>The following string is the syntax for the Logoff method.</p>

<p><code>Logoff()</code></p>
<h2 id='logon'>Logon</h2>
<blockquote>
<p>Example of the syntax for logging into an IBM Cognos Analytics system: </p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example of the syntax for logging into an IBM TM1 system: </p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://myPlanningAnalyticsServer.com"</span><span class="p">,</span>
<span class="s">"admin"</span><span class="p">,</span> <span class="s">"peaches"</span><span class="p">,</span> <span class="s">"localhost/Planning Sample"</span><span class="p">)</span>
</code></pre></div>
<p>The Logon function takes the URL of the server and the credential elements required by IBM® Planning Analytics for Microsoft Excel to perform a logon: user ID, password, and namespace. The namespace parameter is case-sensitive; therefore, you must match the namespace exactly. Planning Analytics for Microsoft Excel uses the Logon function, whether you&#39;re logging into an IBM Cognos Analytics system or an IBM TM1 system.</p>

<p>IBM Cognos® Office stores user credentials only in memory. For this reason, users are responsible for storing their credentials in a secured area and passing them to the logon methods at run time.</p>

<p>If you use the Logon function with incorrect credentials, the system raises a CAMException error, however, no exception is written to the log file indicating a failure. To avoid this situation, remember that strings are case-sensitive and ensure that you use valid user IDs, passwords, and namespaces.</p>

<p>Logon does not appear in the macro list in the Microsoft application because the macro receives an argument. Any macro with parameters is by definition private and private macros are not shown in the macro options by default.</p>

<aside class="notice">
The Logon function cannot be used to log into a cloud-based system.
</aside>
<h3 id='syntax-14'>Syntax</h3>
<p>The following string is the syntax for the Logon method.</p>

<p><code>Boolean Logon (url, user name, password, namespace)</code></p>
<h3 id='arguments-3'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>The URL for the IBM Cognos Analytics or IBM TM1 system, which you want to log on to.</td>
<td>String</td>
</tr>
<tr>
<td>user name</td>
<td>The user name for authentication.</td>
<td>String</td>
</tr>
<tr>
<td>password</td>
<td>The password for authentication.</td>
<td>String</td>
</tr>
<tr>
<td>namespace</td>
<td>The specific namespace for authentication.</td>
<td>String</td>
</tr>
</tbody></table>

<aside class="notice">
Mode 1 authentication requires the combination of the PM Hub host and the TM1 Server as the namespace, separated by a forward slash (/). If your namespace contains a forward slash, the logon is interpreted as a Mode 1 authentication attempt.
</aside>
<h3 id='return-value'>Return value</h3>
<p>Data type: Boolean</p>

<p>The Boolean value is true if successful</p>
<h2 id='publish'>Publish</h2>
<blockquote>
<p>Example of the syntax for publishing to a IBM Cognos Analytics data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Publish</span><span class="p">(</span><span class="s">"CAMID('::Anonymous')/folder[@name='My
Folders']"</span><span class="p">,</span><span class="s">"Description of 'My Folders'"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example of the syntax for publishing to a IBM Planning Analytics data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="p">(</span><span class="s">"https://myPAconnection.PlanningAnalytics.com"</span><span class="p">,</span> <span class="s">"C:\path\to\local\file.xlsx"</span><span class="p">,</span> <span class="s">"/tm1/Planning%20Sample/api/v1/Contents('Applications')/Contents('Planning %20Sample')"</span><span class="p">,</span> <span class="s">"PublishedFileName.xlsx"</span><span class="p">,</span> <span class="s">"My Description"</span><span class="p">,</span> <span class="s">"MyToolTip"</span><span class="p">)</span>
</code></pre></div>
<p>Use Publish to publish content to IBM® Cognos® Connection or to a TM1 Server Application Folder. </p>
<h3 id='syntax-15'>Syntax</h3>
<p>The arguments mirror the entry boxes in the dialog box that is used in the user interface.</p>

<p>Publish does not appear in the macro list in the Microsoft application because the macro receives an argument. Any macro with parameters is by definition private and private macros are not shown in the macro options by default.</p>

<p><code>Publish (url, document path, server path, name, description, screenTip)</code></p>
<h3 id='arguments-4'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>The server to which you are publishing.</td>
<td>String</td>
</tr>
<tr>
<td>document path</td>
<td>The location of the document to be published. It is the local path of the file that you want to publish. If the path of your folder is not correct when you publish using automation, you are again prompted to log on. This is because IBM Cognos does not distinguish between non-existing folders and folders for which the user does not have permissions. This security feature helps to prevent the discovery of the folder path by trial and error.</td>
<td></td>
</tr>
</tbody></table>

<p>In IBM Cognos Analytics, the folder path is a search path. For more information, see the IBM Cognos Analytics Administration Guide. | String
server path | The path in the content store where the document is saved. | String
name | The document name that will appear in IBM Cognos. | String
description | The document description that will appear in IBM Cognos. | String
screenTip | The text that users see when they point to the document in IBM Cognos. | String</p>
<h2 id='publishtm1'>PublishTm1</h2>
<blockquote>
<p>Example for publishing to a TM1 data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">PublishTm1</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Dim</span> <span class="nv">sUrl</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="s">"http://myserver.ibm.com"</span>
    <span class="k">Dim</span> <span class="nv">sDS</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDS</span> <span class="o">=</span> <span class="s">"Planning Sample"</span>
    <span class="k">Dim</span> <span class="nv">sPublishPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sPublishPath</span> <span class="o">=</span> <span class="s">"Contents('Planning Sample')/Contents('Top Down Goals')"</span>
    <span class="k">Dim</span> <span class="nv">sDocumentPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDocumentPath</span> <span class="o">=</span> <span class="s">"C:\Users\JC\Documents\Publish API book.xlsx"</span>
    <span class="k">Dim</span> <span class="nv">sName</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sName</span> <span class="o">=</span> <span class="s">"Publish&amp;Tm1 test1"</span>
    <span class="k">Dim</span> <span class="nv">sDescription</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDescription</span> <span class="o">=</span> <span class="s">"New PublishTm1 api"</span>
    <span class="k">Dim</span> <span class="nv">sScreenTip</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sScreenTip</span> <span class="o">=</span> <span class="s">"test"</span>
    <span class="k">Dim</span> <span class="nv">sIsPrivate</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">sIsPrivate</span> <span class="o">=</span> <span class="k">True</span>
    <span class="k">Dim</span> <span class="nv">sAsReference</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">sAsReference</span> <span class="o">=</span> <span class="k">False</span>

    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">PublishTm1</span> <span class="n">sUrl</span><span class="p">,</span> <span class="n">sDS</span><span class="p">,</span> <span class="n">sPublishPath</span><span class="p">,</span> <span class="n">sDocumentPath</span><span class="p">,</span> <span class="n">sName</span><span class="p">,</span> <span class="n">sDescription</span><span class="p">,</span> <span class="n">sScreenTip</span><span class="p">,</span> <span class="n">sIsPrivate</span><span class="p">,</span> <span class="n">sAsReference</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">Sub</span> 
</code></pre></div>
<p>PublishTm1 is a TM1-specific API that differs from the existing <em>Publish</em> api in the following ways:</p>

<ul>
<li>No need to include <code>/tm1/Planning%20Sample/api/v1/Contents(&#39;Applications&#39;)/</code> in the publish path; the API fills that in during execution.</li>
<li>No need to encode spaces and other special characters.</li>
<li>Takes a Boolean argument to control publish scope (public/private).</li>
<li>Takes a Boolean argument to publish as reference.</li>
</ul>
<h3 id='syntax-16'>Syntax</h3>
<p><code>PublishTm1(string serverURL, string serverName, string publishPath, string documentPath, string name, string description, string screenTip, bool isPrivate, bool asReference)</code></p>
<h2 id='makefoldertm1'>MakeFolderTm1</h2>
<blockquote>
<p>Example for creating a public or private folder at a given location:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">MakeFolderTm1</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span> 
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Dim</span> <span class="nv">sUrl</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="s">"http://ablauts1.fyre.ibm.com"</span>
    <span class="k">Dim</span> <span class="nv">sDS</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDS</span> <span class="o">=</span> <span class="s">"Planning Sample"</span>
    <span class="k">Dim</span> <span class="nv">sFolderPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sFolderPath</span> <span class="o">=</span> <span class="s">"Contents('Planning Sample')/Contents('Top Down Goals')"</span>
    <span class="k">Dim</span> <span class="nv">sFolderName</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sFolderName</span> <span class="o">=</span> <span class="s">"PublishTm1_Folder1"</span>
    <span class="k">Dim</span> <span class="nv">sIsPrivate</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">sIsPrivate</span> <span class="o">=</span> <span class="k">False</span>

    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">MakeFolderTm1</span> <span class="n">sUrl</span><span class="p">,</span> <span class="n">sDS</span><span class="p">,</span> <span class="n">sFolderPath</span><span class="p">,</span> <span class="n">sFolderName</span><span class="p">,</span> <span class="n">sIsPrivate</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">Sub</span> 
</code></pre></div>
<p>MakeFolderTm1 is a TM1-specific API that can create a public or private folder at a given location and differs from the existing <em>Publish</em> api in the following ways:</p>

<ul>
<li>No need to include <code>/tm1/Planning%20Sample/api/v1/Contents(&#39;Applications&#39;)/</code> in the publish path; the API fills that in during execution.</li>
<li>No need to encode spaces and other special characters.</li>
<li>Takes a Boolean argument to control publish scope (public/private).</li>
</ul>
<h3 id='syntax-17'>Syntax</h3>
<p><code>MakeFolderTm1(string serverURL, string serverName, string folderPath, string folderName, bool isPrivate)</code></p>
<h2 id='publishtm1multiple'>PublishTm1Multiple</h2>
<blockquote>
<p>Example for publishing multiple files to a TM1 data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">PublishTm1Multiple</span><span class="p">()</span>
<span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">HANDLER</span>
    <span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span>
        <span class="c1">'Use the message suppressor to turn off all Cognos Office messages.</span>
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Dim</span> <span class="nv">sUrl</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="s">"http://ablauts1.fyre.ibm.com"</span>
    <span class="k">Dim</span> <span class="nv">sDS</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDS</span> <span class="o">=</span> <span class="s">"Planning Sample"</span>
    <span class="k">Dim</span> <span class="nv">sPublishPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sPublishPath</span> <span class="o">=</span> <span class="s">"Contents('Planning Sample')/Contents('Top Down Goals')"</span>
    <span class="k">Dim</span> <span class="nv">sDocumentPaths</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDocumentPaths</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"C:\Users\JC\Documents\Publish API testbook.xlsx, C:\Users\JC\Documents\4420.xlsx"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sNames</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sNames</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"Publish Multiple test 1,Publish Multiple test 2"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sDescriptions</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDescriptions</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"A test of the new PublishTm1 api"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sScreenTips</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sScreenTips</span><span class="p">()</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"A test"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sIsPrivate</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="c1">'To publish with a private scope set this to true</span>
    <span class="n">sIsPrivate</span> <span class="o">=</span> <span class="k">True</span>
    <span class="k">Dim</span> <span class="nv">sAsReference</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="c1">'To publish the file as a reference set this to true</span>
    <span class="n">sAsReference</span> <span class="o">=</span> <span class="k">False</span>

        <span class="c1">'Call the Cognos Office Automation object to publish the file.  </span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">PublishTm1Multiple</span> <span class="n">sUrl</span><span class="p">,</span> <span class="n">sDS</span><span class="p">,</span> <span class="n">sPublishPath</span><span class="p">,</span> <span class="n">sDocumentPaths</span><span class="p">,</span> <span class="n">sNames</span><span class="p">,</span> <span class="n">sDescriptions</span><span class="p">,</span> <span class="n">sScreenTips</span><span class="p">,</span> <span class="n">sIsPrivate</span><span class="p">,</span> <span class="n">sAsReference</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
    <span class="nf">HANDLER</span><span class="p">:</span>  
<span class="k">End</span> <span class="k">Sub</span> 
</code></pre></div>
<p>PublishTm1Multiple is a TM1-specific API that is an expansion on the <em>PublishTm1</em> api, which allows a list of files to be published at once to the same location with the same scope. <em>PublishTm1Multiple</em> differs from the existing <em>Publish</em> api in the following ways:</p>

<ul>
<li>No need to include <code>/tm1/Planning%20Sample/api/v1/Contents(&#39;Applications&#39;)/</code> in the publish path; the API fills that in during execution.</li>
<li>No need to encode spaces and other special characters.</li>
<li>Takes a string array of file locations and names (must be a 1-to-1 pairing of files and file names).</li>
<li>Takes a string array of descriptions and screentips. If these aren’t provided API defaults to an empty string.</li>
<li>Takes a Boolean argument to control publish scope (public/private).</li>
<li>Takes a Boolean argument to publish as reference.</li>
<li>Publish location, scope, and as reference settings are applied to all the files in the array.</li>
</ul>
<h3 id='syntax-18'>Syntax</h3>
<p><code>PublishTm1Multiple(string serverURL, string serverName, string publishPath, string[] documentPaths, string[] names, string[] descriptions, string[] screenTips, bool isPrivate, bool asReference)</code></p>
<h2 id='refresh-task-pane'>Refresh (Task Pane)</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Refresh</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>You can use the Refresh method to refresh the metadata tree in the Task Pane. </p>
<h3 id='syntax-19'>Syntax</h3>
<p>The following is the syntax for the Refresh method.</p>

<p><code>Reporting.TaskPane.Refresh()</code></p>
<h2 id='refreshalldata'>RefreshAllData</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="n">as</span> <span class="kt">Boolean</span>
<span class="n">Copy</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>
<span class="n">Copy</span>

<span class="c1">'Refresh the data if we successfully logged on to the</span>
<span class="n">IBM</span> <span class="n">Cognos</span> <span class="n">server</span><span class="p">.</span>
<span class="n">Copy</span>

<span class="k">If</span> <span class="n">bResult</span> <span class="k">Then</span>
<span class="n">Copy</span>

  <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">RefreshAllData</span>
<span class="n">Copy</span>

<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>RefreshAllData fetches the most current data values from the IBM® TM1 server and updates those values in the current document. </p>
<h3 id='syntax-20'>Syntax</h3>
<p>The system must be successfully logged on to the IBM TM1 server.</p>

<p>If you are using IBM Cognos Office with IBM Cognos® Analytics data, ensure that the Prompt Update Method property on the Manage Data tab in the IBM Cognos pane is set to Use=Display or Do Not Update to complete the operation. Otherwise, the report cannot be refreshed without user intervention and generates errors.</p>

<p><code>RefreshAllData()</code></p>
<h2 id='refreshalldataandformat'>RefreshAllDataAndFormat</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="n">as</span> <span class="kt">Boolean</span>
<span class="n">Copy</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>
<span class="n">Copy</span>

<span class="c1">'Refresh the data and formatting if we successfully logged on to the</span>
<span class="n">IBM</span> <span class="n">Cognos</span> <span class="n">server</span><span class="p">.</span>
<span class="n">Copy</span>

<span class="k">If</span> <span class="n">bResult</span> <span class="k">Then</span>
<span class="n">Copy</span>

  <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">RefreshAllDataAndFormat</span>
<span class="n">Copy</span>

<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>RefreshAllDataAndFormat retrieves the most current data values and formatting from the IBM® Cognos® server and updates those values and formats in the current document.</p>
<h3 id='syntax-21'>Syntax</h3>
<p>The system must be successfully logged on to the IBM Cognos server.</p>

<p>If you are using IBM Cognos Office with IBM Cognos Analytics data, ensure that the <strong>Prompt Update Method</strong> property on the <strong>Manage Data</strong> tab in the IBM Cognos pane is set to <strong>Use=Display</strong> or <strong>Do Not Update</strong> to complete the operation. Otherwise, the report cannot be refreshed without user intervention and generates errors.</p>

<p><code>RefreshAllDataAndFormat()</code></p>
<h2 id='refreshbook'>RefreshBook</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshBook</span>
</code></pre></div>
<p>RefreshBook refreshes all data values in the opened workbooks.</p>
<h3 id='syntax-22'>Syntax</h3>
<p>The following string is the syntax for the RefreshBook method.</p>

<p><code>RefreshBook()</code></p>
<h2 id='refreshselection'>RefreshSelection</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshSelection</span>
</code></pre></div>
<p>RefreshSelection refreshes IBM Planning Analytics for Microsoft Excel data in the active selection. </p>
<h3 id='syntax-23'>Syntax</h3>
<p>The following string is the syntax for the RefreshSelection method.</p>

<p><code>RefreshSelection()</code></p>
<h2 id='refreshsheet'>RefreshSheet</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshSheet</span>
</code></pre></div>
<p>RefreshSheet refreshes IBM Planning Analytics for Microsoft Excel data in the active sheet. </p>
<h3 id='syntax-24'>Syntax</h3>
<p>The following string is the syntax for the RefreshSheet method.</p>

<p><code>RefreshSheet()</code></p>
<h2 id='settings'>Settings</h2>
<blockquote>
<p>Example using <code>SetValue</code></p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">SetValue</span> <span class="s">"GroupingOption"</span><span class="p">,</span> <span class="s">"Full"</span>
</code></pre></div>
<blockquote>
<p>Example using <code>GetValue</code></p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span> <span class="p">(</span><span class="s">"ShowServerInExploration"</span><span class="p">)</span>
</code></pre></div>
<p>The Settings function can be used to enable, disable, or define settings in Planning Analytics for Microsoft Excel. </p>
<h3 id='syntax-25'>Syntax</h3>
<p>SetValue is used to set a value in a setting.</p>

<p><code>Reporting.Settings.SetValue &quot;&lt;setting name&gt;&quot;, &quot;&lt;setting value&gt;&quot;</code></p>

<p>GetValue is used to retrieve a value of a setting.</p>

<p><code>Reporting.Settings.GetValue(&quot;&lt;setting name&gt;&quot;)</code></p>
<h3 id='arguments-5'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>setting name</td>
<td>The name of the setting that you want to enable, disable, or define.</td>
<td>Alphabetic</td>
</tr>
<tr>
<td>setting value</td>
<td>The value that you want to use to enable, disable, or define in the setting.</td>
<td>Alphabetic, alphanumeric, boolean, integer</td>
</tr>
</tbody></table>

<p>View Settings in the <a href="https://www.ibm.com/support/knowledgecenter/SSD29G_2.0.0/com.ibm.swg.ba.cognos.ug_cxr.2.0.0.doc/c_cognosofficereportingsettings.html">CognosOfficeReportingSettings.xml</a> file for a list of the possible settings and values that you can use.</p>
<h2 id='show-task-pane'>Show (Task Pane)</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">False</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Show</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>You can use the Show method to reveal the Task Pane. </p>
<h3 id='syntax-26'>Syntax</h3>
<p>The following is the syntax for the Show method.</p>

<p><code>Reporting.TaskPane.Show()</code></p>
<h2 id='suppressmessages'>SuppressMessages</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Class_Initialize</span><span class="p">()</span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">SuppressMessages</span> <span class="k">True</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Class_Terminate</span><span class="p">()</span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">SuppressMessages</span> <span class="k">False</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>When added to an existing script or function in the Planning Analytics for Microsoft Excel API, SuppressMessages suppresses all of the messages and dialog boxes that may arise from the script or function.</p>

<p>In addition to SuppressMessage, you need to set the Application.DisplayAlerts property in Microsoft Excel to <code>false</code>. For more information about the Application.DisplayAlerts property, see <a href="https://docs.microsoft.com/en-us/office/vba/api/excel.application.displayalerts">Application.DisplayAlerts property</a>.</p>
<h3 id='syntax-27'>Syntax</h3>
<p>The following string is the syntax for the SuppressMessages method.</p>

<p><code>SuppressMessages()</code></p>
<h2 id='traceerror'>TraceError</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">TraceError</span><span class="p">(</span><span class="s">"VBA method failed"</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>The following is an example of the appended error information in the IBM Planning Analytics for Microsoft Excel log file:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="err">[</span><span class="n">Severity</span><span class="o">=</span><span class="k">Error</span><span class="err">]</span>
<span class="err">[</span><span class="n">Exception</span><span class="err">]</span> <span class="n">TraceError</span><span class="p">(</span><span class="kt">String</span> <span class="n">error</span><span class="p">)</span>
<span class="err">[</span><span class="n">Thread</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">Background</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">Pool</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">Domain</span><span class="o">=</span><span class="err">]</span>
<span class="err">[</span><span class="n">System</span><span class="p">.</span><span class="n">Exception</span><span class="err">]</span> <span class="n">VBA</span> <span class="n">API</span> <span class="n">ERROR</span><span class="p">:</span> <span class="n">VBA</span> <span class="n">method</span> <span class="n">failed</span>
</code></pre></div>
<p>TraceError appends error information into the IBM Planning Analytics for Microsoft Excel log file. The user defines the error information they wish to append to the log file for errors.</p>
<h3 id='syntax-28'>Syntax</h3>
<p>The following string is the syntax for the TraceError method.</p>

<p><code>TraceError(&quot;&lt;user defined error information&gt;&quot;)</code></p>
<h2 id='tracelog'>TraceLog</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">strTraceLog</span> <span class="n">as</span> <span class="kt">String</span>
<span class="n">strTraceLog</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">TraceLog</span>
<span class="n">MsgBox</span> <span class="n">strTraceLog</span>
</code></pre></div>
<p>TraceLog returns all the automation activities and errors.</p>
<h3 id='syntax-29'>Syntax</h3>
<p>The following string is the syntax for the TraceLog  method.</p>

<p><code>*String* TraceLog ()</code></p>
<h3 id='return-value-2'>Return Value</h3>
<p>Data type: String</p>

<p>The value of the logging item as string</p>
<h2 id='unlinkalldata'>UnlinkAllData</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">UnlinkAllData</span>
</code></pre></div>
<p>UnlinkAllData disconnects all the IBM® Cognos® data values in the current document. The values are no longer updated with subsequent calls to RefreshAllData. The values become static. </p>
<h3 id='syntax-30'>Syntax</h3>
<p>For IBM Cognos Office, any IBM Cognos data values that are imported into the current document after UnlinkAllData is called will continue to be linked to the IBM Cognos data source.</p>

<p>The values can be updated with new server data using the RefreshAllData call.</p>

<p><code>UnlinkAllData ()</code></p>
<h2 id='unlinkbook'>UnlinkBook</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">UnlinkBook</span> 
</code></pre></div>
<p>UnlinkBook unlinks the active book from the connection.</p>
<h3 id='syntax-31'>Syntax</h3>
<p>The following string is the syntax for the UnlinkBook method.</p>

<p><code>UnlinkBook()</code></p>
<h2 id='unlinkselection'>UnlinkSelection</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">UnlinkSelection</span>
</code></pre></div>
<p>UnlinkSelection disconnects the selected data values. The values are no longer updated with subsequent calls to Refreshable. The values become static.</p>
<h3 id='syntax-32'>Syntax</h3>
<p>The following string is the syntax for the UnlinkSelection method.</p>

<p><code>UnlinkSelection()</code></p>
<h2 id='unlinksheet'>UnlinkSheet</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">UnlinkSheet</span> 
</code></pre></div>
<p>UnlinkSheet unlinks the active sheet from the connection.</p>
<h3 id='syntax-33'>Syntax</h3>
<p>The following string is the syntax for the UnlinkSheet  method.</p>

<p><code>UnlinkSheet()</code></p>
<h2 id='updateserverurl'>UpdateServerUrl</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">UpdateServerUrl</span> <span class="s">"http://testserver1/cgi-bin/cognos.cgi"</span> 
<span class="s">"http://prodserver1/cgi-bin/cognos.cgi"</span>
</code></pre></div>
<blockquote>
<p>The following example uses only the part of the URL that is changing:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">UpdateServerUrl</span> <span class="s">"testserver1"</span> <span class="s">"prodserver1"</span>
</code></pre></div>
<p>Use UpdateServerUrl to update the IBM® Cognos® server information for existing reports and formulas. </p>
<h3 id='syntax-34'>Syntax</h3>
<p>The UpdateServerUrl method takes two arguments: the old server URL and the new server URL. These arguments mirror the entry boxes in the <strong>Update System</strong> dialog box. To gain access to this control from IBM Cognos, click the <strong>Options</strong> button on the IBM Cognos ribbon, then click <strong>Update System Utility</strong>.</p>

<p>The UpdateServerUrl method replaces the server information for existing reports. When running this command, the name of the package or data source remains the same. You can use this method to change only one server, such as a test server to a production server. The URL arguments can be full or partial URLs. If any argument is empty, this command does nothing, however, running this command with empty arguments has the potential to corrupt the report. Server information is stored in both the server property and the serialized report property. Running an empty command could cause these two instances to get out of sync.</p>

<p>Because the UpdateServerUrl method searches and replaces strings, it is possible to use only part of the URL, provided it is a unique substring. </p>

<aside class="notice">
The UpdateServerUrl search looks at all data in the workbook and updates data that matches the search string, not just report properties containing the URL string. Therefore, when you use only part or all of the original URL string with the UpdateServerUrl method, you will change all data that matches the search string.
</aside>

<p><code>UpdateServerUrl &quot;old server URL string&quot; &quot;new server URL string&quot;</code></p>
<h3 id='arguments-6'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>old server URL string</td>
<td>Indicates the URL of the source or current system.</td>
<td>String</td>
</tr>
<tr>
<td>new server URL string</td>
<td>Indicates the URL of the target system.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='useragent'>UserAgent</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>  <span class="k">Dim</span> <span class="nv">useragent</span> <span class="n">as</span> <span class="kt">String</span>
  <span class="n">useragent</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">UserAgent</span>
</code></pre></div>
<p>Returns the product and build version details. For example, <code>PAfE/2.0.66.9 (8590999552); Excel/16.0.13127</code>.</p>
<h3 id='syntax-35'>Syntax</h3>
<p>The following string is the syntax for the UserAgent method. 
<code>Reporting.UserAgent</code></p>
<h2 id='useragentscrelease'>UserAgentSCRelease</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>  <span class="k">Dim</span> <span class="nv">release</span> <span class="n">as</span> <span class="kt">String</span>
  <span class="n">release</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">UserAgentSCRelease</span>
</code></pre></div>
<p>Returns the condensed product version details. For example, <code>66.9</code>.</p>
<h3 id='syntax-36'>Syntax</h3>
<p>The following string is the syntax for the UserAgentSCRelease method.
<code>Reporting.UserAgentSCRelease</code></p>
<h2 id='useragentscreleasefull'>UserAgentSCReleaseFull</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>  <span class="k">Dim</span> <span class="nv">releasefull</span> <span class="n">as</span> <span class="kt">String</span>
  <span class="n">releasefull</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">UserAgentSCReleaseFull</span>
</code></pre></div>
<p>Returns the full product version details. For example, <code>2.0.66.9</code>.</p>
<h3 id='syntax-37'>Syntax</h3>
<p>The following string is the syntax for the UserAgentSCReleaseFull method.
<code>Reporting.UserAgentSCReleaseFull</code></p>
<h2 id='wait'>Wait</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">Wait</span>
</code></pre></div>
<blockquote>
<p>Usage example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Sub</span> <span class="nf">Wait</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">).</span><span class="n">Commit</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Wait</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">).</span><span class="n">Refresh</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Sub</span> <span class="nf">Wait</span><span class="p">()</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshBook</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">Wait</span>
    <span class="n">MsgBox</span> <span class="s">"Refresh complete!"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Wait holds the VBA thread until all prior IBM Planning Analytics for Microsoft Excel background tasks are complete. </p>
<h3 id='syntax-38'>Syntax</h3>
<p>The following string is the syntax for the Wait method.</p>

<p><code>Wait()</code></p>
