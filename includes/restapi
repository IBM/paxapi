<h1 id='rest-api'>REST API</h1>
<p>You can use REST APIs to communicate with the TM1 Server.</p>

<p>Before you begin, make sure that you&#39;ve returned the connection object. The connection object will allow you to implement the REST request methods (GET, POST, DELETE, PATCH) and communicate with the TM1 Server.</p>

<p>To learn more about the connection object, see <a href="#getconnection">GetConnection</a>.</p>
<h2 id='get-requests'>GET requests</h2>
<blockquote>
<p>Example of how you can use a <code>GET</code> request in a VBA module to return a JSON object.</p>
</blockquote>
<pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">OData</span><span class="p">(</span><span class="n">Server</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'OData endpoint</span>
    <span class="n">OData</span> <span class="o">=</span> <span class="n">HubEndpoint</span> <span class="o">+</span> <span class="s">"server('"</span> <span class="o">+</span> <span class="n">Server</span> <span class="o">+</span> <span class="s">"')/api/v1"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Current</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">Current</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruServer"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetCurrentServer</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCubeMRU</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCube</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="k">Dim</span> <span class="nv">sServer</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruPackage"</span><span class="p">)</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
   <span class="n">sServerCube</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
   <span class="n">sServer</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCube</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">":"</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">GetCurrentServer</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServer</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">oDataGet</span><span class="p">(</span><span class="n">path</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">JSONObjectWrapper</span>
    <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">JSONParser</span>
    <span class="k">Dim</span> <span class="nv">response</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Set</span> <span class="n">response</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetConnection</span><span class="p">(</span><span class="n">Current</span><span class="p">).</span><span class="n">Get</span><span class="p">(</span><span class="n">OData</span><span class="p">(</span><span class="n">GetCurrentServer</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">"/"</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre>
<p>Use <code>GET</code> requests to return data from the TM1 Server.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the <code>GET</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).Get(&lt;PATH&gt;)</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you are using the GET request on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path that you are using the GET request on.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='post-requests'>POST requests</h2>
<blockquote>
<p>Example of how you can use a <code>POST</code> request in a VBA module to update a component.</p>
</blockquote>
<pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">HubEndpoint</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'Endpoint that CAFE connects to</span>
    <span class="n">HubEndpoint</span> <span class="o">=</span> <span class="s">"pmhub/pm/tm1/"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">OData</span><span class="p">(</span><span class="n">Server</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'OData endpoint</span>
    <span class="n">OData</span> <span class="o">=</span> <span class="n">HubEndpoint</span> <span class="o">+</span> <span class="s">"server('"</span> <span class="o">+</span> <span class="n">Server</span> <span class="o">+</span> <span class="s">"')/api/v1"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Current</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">Current</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruServer"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetCurrentServer</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCubeMRU</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCube</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="k">Dim</span> <span class="nv">sServer</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruPackage"</span><span class="p">)</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
   <span class="n">sServerCube</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
   <span class="n">sServer</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCube</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">":"</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>

   <span class="n">GetCurrentServer</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServer</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">oDataPost</span><span class="p">(</span><span class="n">path</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">payload</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">JSONObjectWrapper</span>
    <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">JSONParser</span>
    <span class="k">Dim</span> <span class="nv">response</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Set</span> <span class="n">response</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetConnection</span><span class="p">(</span><span class="n">Current</span><span class="p">).</span><span class="n">Post</span><span class="p">(</span><span class="n">OData</span><span class="p">(</span><span class="n">GetCurrentServer</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">"/"</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre>
<p>Use <code>POST</code> requests to store or update components in the TM1 Server.</p>
<h3 id='syntax-2'>Syntax</h3>
<p>The following string is the syntax for the <code>POST</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).Post(&lt;PATH&gt;, &lt;PAYLOAD&gt;)</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to store or update on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to store to or update.</td>
<td>String</td>
</tr>
<tr>
<td>PAYLOAD</td>
<td>The JSON payload that you are storing or updating to the TM1 Server.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='delete-requests'>DELETE requests</h2>
<blockquote>
<p>Example of how you can use a <code>DELETE</code> request in a VBA module to delete data.</p>
</blockquote>
<pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">HubEndpoint</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'Endpoint that CAFE connects to</span>
    <span class="n">HubEndpoint</span> <span class="o">=</span> <span class="s">"pmhub/pm/tm1/"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">OData</span><span class="p">(</span><span class="n">Server</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'OData endpoint</span>
    <span class="n">OData</span> <span class="o">=</span> <span class="n">HubEndpoint</span> <span class="o">+</span> <span class="s">"server('"</span> <span class="o">+</span> <span class="n">Server</span> <span class="o">+</span> <span class="s">"')/api/v1"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Current</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">Current</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruServer"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetCurrentServer</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCubeMRU</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCube</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="k">Dim</span> <span class="nv">sServer</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruPackage"</span><span class="p">)</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
   <span class="n">sServerCube</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
   <span class="n">sServer</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCube</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">":"</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>

   <span class="n">GetCurrentServer</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServer</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">oDataDelete</span><span class="p">(</span><span class="n">path</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">JSONObjectWrapper</span>
    <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">JSONParser</span>
    <span class="k">Dim</span> <span class="nv">response</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetConnection</span><span class="p">(</span><span class="n">Current</span><span class="p">).</span><span class="n">Delete</span><span class="p">(</span><span class="n">OData</span><span class="p">(</span><span class="n">GetCurrentServer</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">"/"</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre>
<p>Use <code>DELETE</code> requests to delete components or data in the TM1 Server.</p>
<h3 id='syntax-3'>Syntax</h3>
<p>The following string is the syntax for the <code>DELETE</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).Delete(&lt;PATH&gt;)</code></p>
<h3 id='arguments-3'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to delete.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to delete.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='patch-requests'>PATCH requests</h2>
<p>Use <code>PATCH</code> requests to update components in the TM1 Server at a target location.</p>
<h3 id='syntax-4'>Syntax</h3>
<p>The following string is the syntax for the <code>PATCH</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).PATCH(&lt;PATH&gt;, &lt;PAYLOAD&gt;)</code></p>
<h3 id='arguments-4'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to update on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to update.</td>
<td>String</td>
</tr>
<tr>
<td>PAYLOAD</td>
<td>The JSON payload that you are storing in the TM1 Server.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='put-requests'>PUT requests</h2>
<p>Use <code>PUT</code> requests to place components in the TM1 Server at a target location.</p>
<h3 id='syntax-5'>Syntax</h3>
<p>The following string is the syntax for the <code>PUT</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).PUT(&lt;PATH&gt;, &lt;PAYLOAD&gt;)</code></p>
<h3 id='arguments-5'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to update on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to place.</td>
<td>String</td>
</tr>
<tr>
<td>PAYLOAD</td>
<td>The JSON payload that you are storing in the TM1 Server.</td>
<td>String</td>
</tr>
</tbody></table>
