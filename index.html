
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>PAx API</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nn {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nl {
  color: #ffffff;
  background-color: #272822;
}
.highlight .ni {
  color: #ffffff;
  background-color: #272822;
}
.highlight .bp {
  color: #ffffff;
  background-color: #272822;
}
.highlight .vg {
  color: #ffffff;
  background-color: #272822;
}
.highlight .vi {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
  background-color: #272822;
}
.highlight .w {
  color: #ffffff;
  background-color: #272822;
}
.highlight {
  color: #ffffff;
  background-color: #272822;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
  background-color: #272822;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-bcd3675c.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-c427a123.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;vb&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-60038d96.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="vb">vb</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#report-issues" class="toc-h2 toc-link" data-title="Report issues">Report issues</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#set-up" class="toc-h1 toc-link" data-title="Set up">Set up</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#before-you-begin" class="toc-h2 toc-link" data-title="Before you begin">Before you begin</a>
                  </li>
                  <li>
                    <a href="#procedure" class="toc-h2 toc-link" data-title="Procedure">Procedure</a>
                  </li>
                  <li>
                    <a href="#results" class="toc-h2 toc-link" data-title="Results">Results</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#log-automation-activities-and-errors" class="toc-h1 toc-link" data-title="Log automation activities and errors">Log automation activities and errors</a>
          </li>
          <li>
            <a href="#necessary-ibm-cognos-automation-api-references" class="toc-h1 toc-link" data-title="Necessary IBM Cognos automation API references">Necessary IBM Cognos automation API references</a>
          </li>
          <li>
            <a href="#common-view-specification-schema" class="toc-h1 toc-link" data-title="Common View Specification Schema">Common View Specification Schema</a>
          </li>
          <li>
            <a href="#global-api-functions" class="toc-h1 toc-link" data-title="Global API functions">Global API functions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#getconnection" class="toc-h2 toc-link" data-title="GetConnection">GetConnection</a>
                  </li>
                  <li>
                    <a href="#changedatasource-task-pane" class="toc-h2 toc-link" data-title="ChangeDataSource (Task Pane)">ChangeDataSource (Task Pane)</a>
                  </li>
                  <li>
                    <a href="#clearalldata" class="toc-h2 toc-link" data-title="ClearAllData">ClearAllData</a>
                  </li>
                  <li>
                    <a href="#clearbook" class="toc-h2 toc-link" data-title="ClearBook">ClearBook</a>
                  </li>
                  <li>
                    <a href="#clearcache" class="toc-h2 toc-link" data-title="ClearCache">ClearCache</a>
                  </li>
                  <li>
                    <a href="#clearselection" class="toc-h2 toc-link" data-title="ClearSelection">ClearSelection</a>
                  </li>
                  <li>
                    <a href="#clearsheet" class="toc-h2 toc-link" data-title="ClearSheet">ClearSheet</a>
                  </li>
                  <li>
                    <a href="#hide-task-pane" class="toc-h2 toc-link" data-title="Hide (Task Pane)">Hide (Task Pane)</a>
                  </li>
                  <li>
                    <a href="#httplogoncredentials" class="toc-h2 toc-link" data-title="HttpLogonCredentials">HttpLogonCredentials</a>
                  </li>
                  <li>
                    <a href="#isvisible-task-pane" class="toc-h2 toc-link" data-title="IsVisible (Task Pane)">IsVisible (Task Pane)</a>
                  </li>
                  <li>
                    <a href="#logoff" class="toc-h2 toc-link" data-title="Logoff">Logoff</a>
                  </li>
                  <li>
                    <a href="#logon" class="toc-h2 toc-link" data-title="Logon">Logon</a>
                  </li>
                  <li>
                    <a href="#publish" class="toc-h2 toc-link" data-title="Publish">Publish</a>
                  </li>
                  <li>
                    <a href="#publishtm1" class="toc-h2 toc-link" data-title="PublishTm1">PublishTm1</a>
                  </li>
                  <li>
                    <a href="#makefoldertm1" class="toc-h2 toc-link" data-title="MakeFolderTm1">MakeFolderTm1</a>
                  </li>
                  <li>
                    <a href="#publishtm1multiple" class="toc-h2 toc-link" data-title="PublishTm1Multiple">PublishTm1Multiple</a>
                  </li>
                  <li>
                    <a href="#refresh-task-pane" class="toc-h2 toc-link" data-title="Refresh (Task Pane)">Refresh (Task Pane)</a>
                  </li>
                  <li>
                    <a href="#refreshalldata" class="toc-h2 toc-link" data-title="RefreshAllData">RefreshAllData</a>
                  </li>
                  <li>
                    <a href="#refreshalldataandformat" class="toc-h2 toc-link" data-title="RefreshAllDataAndFormat">RefreshAllDataAndFormat</a>
                  </li>
                  <li>
                    <a href="#refreshbook" class="toc-h2 toc-link" data-title="RefreshBook">RefreshBook</a>
                  </li>
                  <li>
                    <a href="#refreshselection" class="toc-h2 toc-link" data-title="RefreshSelection">RefreshSelection</a>
                  </li>
                  <li>
                    <a href="#refreshsheet" class="toc-h2 toc-link" data-title="RefreshSheet">RefreshSheet</a>
                  </li>
                  <li>
                    <a href="#settings" class="toc-h2 toc-link" data-title="Settings">Settings</a>
                  </li>
                  <li>
                    <a href="#show-task-pane" class="toc-h2 toc-link" data-title="Show (Task Pane)">Show (Task Pane)</a>
                  </li>
                  <li>
                    <a href="#suppressmessages" class="toc-h2 toc-link" data-title="SuppressMessages">SuppressMessages</a>
                  </li>
                  <li>
                    <a href="#traceerror" class="toc-h2 toc-link" data-title="TraceError">TraceError</a>
                  </li>
                  <li>
                    <a href="#tracelog" class="toc-h2 toc-link" data-title="TraceLog">TraceLog</a>
                  </li>
                  <li>
                    <a href="#unlinkalldata" class="toc-h2 toc-link" data-title="UnlinkAllData">UnlinkAllData</a>
                  </li>
                  <li>
                    <a href="#unlinkbook" class="toc-h2 toc-link" data-title="UnlinkBook">UnlinkBook</a>
                  </li>
                  <li>
                    <a href="#unlinkselection" class="toc-h2 toc-link" data-title="UnlinkSelection">UnlinkSelection</a>
                  </li>
                  <li>
                    <a href="#unlinksheet" class="toc-h2 toc-link" data-title="UnlinkSheet">UnlinkSheet</a>
                  </li>
                  <li>
                    <a href="#updateserverurl" class="toc-h2 toc-link" data-title="UpdateServerUrl">UpdateServerUrl</a>
                  </li>
                  <li>
                    <a href="#useragent" class="toc-h2 toc-link" data-title="UserAgent">UserAgent</a>
                  </li>
                  <li>
                    <a href="#useragentscrelease" class="toc-h2 toc-link" data-title="UserAgentSCRelease">UserAgentSCRelease</a>
                  </li>
                  <li>
                    <a href="#useragentscreleasefull" class="toc-h2 toc-link" data-title="UserAgentSCReleaseFull">UserAgentSCReleaseFull</a>
                  </li>
                  <li>
                    <a href="#wait" class="toc-h2 toc-link" data-title="Wait">Wait</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#exploration-api-functions" class="toc-h1 toc-link" data-title="Exploration API functions">Exploration API functions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#clear-exploration" class="toc-h2 toc-link" data-title="Clear (Exploration)">Clear (Exploration)</a>
                  </li>
                  <li>
                    <a href="#create-exploration" class="toc-h2 toc-link" data-title="Create (Exploration)">Create (Exploration)</a>
                  </li>
                  <li>
                    <a href="#createfromcvs-exploration" class="toc-h2 toc-link" data-title="CreateFromCVS (Exploration)">CreateFromCVS (Exploration)</a>
                  </li>
                  <li>
                    <a href="#createfrommdx-exploration" class="toc-h2 toc-link" data-title="CreateFromMDX (Exploration)">CreateFromMDX (Exploration)</a>
                  </li>
                  <li>
                    <a href="#getcolumnsuppression" class="toc-h2 toc-link" data-title="GetColumnSuppression">GetColumnSuppression</a>
                  </li>
                  <li>
                    <a href="#getrowsuppression" class="toc-h2 toc-link" data-title="GetRowSuppression">GetRowSuppression</a>
                  </li>
                  <li>
                    <a href="#getspecification" class="toc-h2 toc-link" data-title="GetSpecification">GetSpecification</a>
                  </li>
                  <li>
                    <a href="#getvalue" class="toc-h2 toc-link" data-title="GetValue">GetValue</a>
                  </li>
                  <li>
                    <a href="#refresh-exploration" class="toc-h2 toc-link" data-title="Refresh (Exploration)">Refresh (Exploration)</a>
                  </li>
                  <li>
                    <a href="#swaprowsandcolumns" class="toc-h2 toc-link" data-title="SwapRowsAndColumns">SwapRowsAndColumns</a>
                  </li>
                  <li>
                    <a href="#setrowsuppression" class="toc-h2 toc-link" data-title="SetRowSuppression">SetRowSuppression</a>
                  </li>
                  <li>
                    <a href="#setcolumnsuppression" class="toc-h2 toc-link" data-title="SetColumnSuppression">SetColumnSuppression</a>
                  </li>
                  <li>
                    <a href="#setspecification" class="toc-h2 toc-link" data-title="SetSpecification">SetSpecification</a>
                  </li>
                  <li>
                    <a href="#setvalue" class="toc-h2 toc-link" data-title="SetValue">SetValue</a>
                  </li>
                  <li>
                    <a href="#unlink" class="toc-h2 toc-link" data-title="Unlink">Unlink</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#quick-report-api-functions" class="toc-h1 toc-link" data-title="Quick Report API functions">Quick Report API functions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#clear-quick-report" class="toc-h2 toc-link" data-title="Clear (Quick Report)">Clear (Quick Report)</a>
                  </li>
                  <li>
                    <a href="#columnhierarchies" class="toc-h2 toc-link" data-title="ColumnHierarchies">ColumnHierarchies</a>
                  </li>
                  <li>
                    <a href="#commit" class="toc-h2 toc-link" data-title="Commit">Commit</a>
                  </li>
                  <li>
                    <a href="#create-quick-report" class="toc-h2 toc-link" data-title="Create (Quick Report)">Create (Quick Report)</a>
                  </li>
                  <li>
                    <a href="#createfromcvs-quick-report" class="toc-h2 toc-link" data-title="CreateFromCVS (Quick Report)">CreateFromCVS (Quick Report)</a>
                  </li>
                  <li>
                    <a href="#createfrommdx-quick-report" class="toc-h2 toc-link" data-title="CreateFromMDX (Quick Report)">CreateFromMDX (Quick Report)</a>
                  </li>
                  <li>
                    <a href="#cube" class="toc-h2 toc-link" data-title="Cube">Cube</a>
                  </li>
                  <li>
                    <a href="#datasource" class="toc-h2 toc-link" data-title="DataSource">DataSource</a>
                  </li>
                  <li>
                    <a href="#enableindents" class="toc-h2 toc-link" data-title="EnableIndents">EnableIndents</a>
                  </li>
                  <li>
                    <a href="#executequery" class="toc-h2 toc-link" data-title="ExecuteQuery">ExecuteQuery</a>
                  </li>
                  <li>
                    <a href="#gettuple" class="toc-h2 toc-link" data-title="GetTuple">GetTuple</a>
                  </li>
                  <li>
                    <a href="#getspecification" class="toc-h2 toc-link" data-title="GetSpecification">GetSpecification</a>
                  </li>
                  <li>
                    <a href="#getreport" class="toc-h2 toc-link" data-title="GetReport">GetReport</a>
                  </li>
                  <li>
                    <a href="#id" class="toc-h2 toc-link" data-title="ID">ID</a>
                  </li>
                  <li>
                    <a href="#name" class="toc-h2 toc-link" data-title="Name">Name</a>
                  </li>
                  <li>
                    <a href="#rebuild" class="toc-h2 toc-link" data-title="Rebuild">Rebuild</a>
                  </li>
                  <li>
                    <a href="#rebuildspecification" class="toc-h2 toc-link" data-title="RebuildSpecification">RebuildSpecification</a>
                  </li>
                  <li>
                    <a href="#refresh-quick-report" class="toc-h2 toc-link" data-title="Refresh (Quick Report)">Refresh (Quick Report)</a>
                  </li>
                  <li>
                    <a href="#replace" class="toc-h2 toc-link" data-title="Replace">Replace</a>
                  </li>
                  <li>
                    <a href="#replacewithformats" class="toc-h2 toc-link" data-title="ReplaceWithFormats">ReplaceWithFormats</a>
                  </li>
                  <li>
                    <a href="#rowhierarchies" class="toc-h2 toc-link" data-title="RowHierarchies">RowHierarchies</a>
                  </li>
                  <li>
                    <a href="#select" class="toc-h2 toc-link" data-title="Select">Select</a>
                  </li>
                  <li>
                    <a href="#setslicer" class="toc-h2 toc-link" data-title="SetSlicer">SetSlicer</a>
                  </li>
                  <li>
                    <a href="#slicerhierarchies" class="toc-h2 toc-link" data-title="SlicerHierarchies">SlicerHierarchies</a>
                  </li>
                  <li>
                    <a href="#useserverformats" class="toc-h2 toc-link" data-title="UseServerFormats">UseServerFormats</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#dynamic-report-api-functions" class="toc-h1 toc-link" data-title="Dynamic Report API functions">Dynamic Report API functions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-dynamic-report" class="toc-h2 toc-link" data-title="Create (Dynamic Report)">Create (Dynamic Report)</a>
                  </li>
                  <li>
                    <a href="#createfrommdx-dynamic-report" class="toc-h2 toc-link" data-title="CreatefromMDX (Dynamic Report)">CreatefromMDX (Dynamic Report)</a>
                  </li>
                  <li>
                    <a href="#getmdx" class="toc-h2 toc-link" data-title="GetMDX">GetMDX</a>
                  </li>
                  <li>
                    <a href="#formatareavisible" class="toc-h2 toc-link" data-title="FormatAreaVisible">FormatAreaVisible</a>
                  </li>
                  <li>
                    <a href="#refresh-dynamic-report" class="toc-h2 toc-link" data-title="Refresh (Dynamic Report)">Refresh (Dynamic Report)</a>
                  </li>
                  <li>
                    <a href="#rebuild-dynamic-report" class="toc-h2 toc-link" data-title="Rebuild (Dynamic Report)">Rebuild (Dynamic Report)</a>
                  </li>
                  <li>
                    <a href="#rebuildactivesheet" class="toc-h2 toc-link" data-title="RebuildActiveSheet">RebuildActiveSheet</a>
                  </li>
                  <li>
                    <a href="#rebuildactivebook" class="toc-h2 toc-link" data-title="RebuildActiveBook">RebuildActiveBook</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#custom-report-api-function" class="toc-h1 toc-link" data-title="Custom Report API function">Custom Report API function</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-custom-report" class="toc-h2 toc-link" data-title="Create (Custom Report)">Create (Custom Report)</a>
                  </li>
                  <li>
                    <a href="#createfrommdx-custom-report" class="toc-h2 toc-link" data-title="CreatefromMDX (Custom Report)">CreatefromMDX (Custom Report)</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#turbointegrator-functions" class="toc-h1 toc-link" data-title="TurboIntegrator functions">TurboIntegrator functions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#before-you-begin" class="toc-h2 toc-link" data-title="Before you begin">Before you begin</a>
                  </li>
                  <li>
                    <a href="#procedure" class="toc-h2 toc-link" data-title="Procedure">Procedure</a>
                  </li>
                  <li>
                    <a href="#results" class="toc-h2 toc-link" data-title="Results">Results</a>
                  </li>
                  <li>
                    <a href="#executefunction" class="toc-h2 toc-link" data-title="ExecuteFunction">ExecuteFunction</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#rest-api" class="toc-h1 toc-link" data-title="REST API">REST API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-requests" class="toc-h2 toc-link" data-title="GET requests">GET requests</a>
                  </li>
                  <li>
                    <a href="#post-requests" class="toc-h2 toc-link" data-title="POST requests">POST requests</a>
                  </li>
                  <li>
                    <a href="#delete-requests" class="toc-h2 toc-link" data-title="DELETE requests">DELETE requests</a>
                  </li>
                  <li>
                    <a href="#patch-requests" class="toc-h2 toc-link" data-title="PATCH requests">PATCH requests</a>
                  </li>
                  <li>
                    <a href="#put-requests" class="toc-h2 toc-link" data-title="PUT requests">PUT requests</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#script-files" class="toc-h1 toc-link" data-title="Script files">Script files</a>
          </li>
          <li>
            <a href="#macro-files" class="toc-h1 toc-link" data-title="Macro files">Macro files</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#macros" class="toc-h2 toc-link" data-title="Macros">Macros</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#examples-of-processing" class="toc-h1 toc-link" data-title="Examples of processing">Examples of processing</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#processing-outside-of-vba" class="toc-h2 toc-link" data-title="Processing outside of VBA">Processing outside of VBA</a>
                  </li>
                  <li>
                    <a href="#processing-within-vba" class="toc-h2 toc-link" data-title="Processing within VBA">Processing within VBA</a>
                  </li>
                  <li>
                    <a href="#troubleshooting-issues" class="toc-h2 toc-link" data-title="Troubleshooting issues">Troubleshooting issues</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://www.ibm.com/support/knowledgecenter/SSD29G_2.0.0/kc_gen/com.ibm.swg.ba.cognos.ipa.doc_using_planning_analytics_toc-gen2.html'>Full Documentation Here</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Using an application programming interface (API), you can automate the refreshing or publishing of content.</p>

<p>You can use the API to create a scheduled batch program to refresh content on a daily, weekly, or monthly basis so that, as your period data changes, the affected files are kept up-to-date.</p>

<p>You can call the API within Microsoft Excel workbooks using VBA or using VBS and a command line interface. For these types of automation to work, you must register one or more macros within the workbook.</p>

<p>If you have IBM® Cognos® Office installed, you can also use the API in Microsoft Word and Microsoft PowerPoint.</p>

<p>When using sample macros and script files as part of your own processing functions, remember that the API is accessible only as user defined functions (UDFs). UDFs are functions created in Visual Basic for Applications (VBA). In this case, however, the UDFs are created within the IBM Cognos solution and are called from VBA.</p>

<p>To help you understand what is possible using this API, several samples are provided. You can use the samples to help you create your own solutions.</p>

<ul>
<li>Creating VBA macros</li>
<li>Passing parameters, leveraging VBS and the command line interface</li>
</ul>

<p>In addition to these capabilities, you can schedule scripts, either ones that you create or the samples, to run as a batch process at a set time.</p>

<p>To use automation, you must set your macro security to an appropriate level in your Microsoft application. You can set the macro security level using one of the following options depending on your version of Microsoft Office.</p>

<ul>
<li>Change the security level of your Microsoft application to medium or low.</li>
<li>Change the trusted publishers setting of your Microsoft application so that installed add-ins or templates are trusted. </li>
</ul>
<h2 id='report-issues'>Report issues</h2>
<p>Any issues or errors related to the Planning Analytics for Microsoft Excel API documentation can be reported in <a href="https://github.com/IBM/paxapi/issues">GitHub</a>.</p>

<p>To report any issues or errors related to Planning Analytics for Microsoft Excel API features or functionality, use the <a href="https://community.ibm.com/community/user/businessanalytics/communities/community-home?CommunityKey=8fde0600-e22b-4178-acf5-bf4eda43146b">IBM Planning Analytics Community</a>.</p>
<h1 id='set-up'>Set up</h1>
<p>The quickest way to set up automation is to import the <code>CognosOfficeAutomationExample.bas</code> file into the Microsoft application.</p>

<p>This file contains all the necessary macros, including the CognosOfficeAutomationObject macro. Alternatively, you can create templates that contain this .bas file to supply the code for logging on to IBM® Cognos® application, refreshing the content of specified workbooks, documents, or presentations, and logging off.</p>

<p>After the reference to IBM Cognos automation is established, any macro in VBA can call the functions exposed in the IBM Cognos automation API.</p>

<p>If the Microsoft application is open when a command is executing, the command executes in interactive mode. If the Microsoft application is closed when the command is executing, the command executes in batch mode. Executing in batch mode means that all display alerts are turned off.</p>

<p>Because the object is obtained at run time and there is no type library installed on the client machine, you cannot use IntelliSense to determine what properties and methods are available on the object.</p>
<h2 id='before-you-begin'>Before you begin</h2>
<p>To use the IBM Cognos automation macro files, you must import the <code>CognosOfficeMessageSuppressor.cls</code> file. The .cls file contains the SuppressMessages function that allows you to disable the standard alerts and messages.</p>
<h2 id='procedure'>Procedure</h2>
<ol>
<li>Open a new Office document, workbook, or presentation.</li>
<li>Customize the ribbon to display the <strong>Developer</strong> tab.</li>
<li>Click the <strong>Developer</strong> tab, and then click <strong>Visual Basic</strong>.</li>
<li>Do the following based on the Microsoft Office application you are using:

<ul>
<li>For Microsoft Excel and Microsoft PowerPoint, right-click <strong>VBAProject</strong> and click <strong>Import File</strong>.</li>
<li>For Microsoft Word, right-click <strong>Project</strong> and click <strong>Import File</strong>.
The Import File dialog box appears.</li>
</ul></li>
<li>Browse to the location where the IBM Cognos Automation macro files are installed.
The default location is <code>&lt;client_installation_directory&gt;\Automation</code>.</li>
<li>For Microsoft Excel or Microsoft Word click the <code>CognosOfficeAutomationExample.bas</code> file or for Microsoft PowerPoint click the CognosOfficeAutomationPPExample.bas file and import it into the VBA project.
Do not edit this code module. Do not import both files, which are application specific. This will cause problems for the Open routine.</li>
<li>Repeat steps 3 to 5 to import the <code>CognosOfficeMessageSuppressor.cls</code> file.</li>
<li>Close the Visual Basic Editor and return to the IBM Cognos application.</li>
<li>Save the file as a template, close it, and then reopen the template file.</li>
</ol>
<h2 id='results'>Results</h2>
<p>You can now call the macros contained in the Cognos automation macro files from the VBA code that you write in Excel, Word, or PowerPoint.</p>
<h1 id='log-automation-activities-and-errors'>Log automation activities and errors</h1>
<p>Use the automation log to track automation activities and troubleshoot problems with automation tools and scripts. The automation log is automatically generated when you run an automation script.</p>

<p>The automation log is returned using a call to the Automation API function TraceLog. For information about the TraceLog function, see <a href="#tracelog">TraceLog</a>.</p>
<h1 id='necessary-ibm-cognos-automation-api-references'>Necessary IBM Cognos automation API references</h1>
<blockquote>
<p>m_o Cafe object reference</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>    <span class="k">Dim</span> <span class="nv">m_oCAFE</span> <span class="ow">As</span> <span class="kt">Object</span>
</code></pre></div>
<blockquote>
<p>m_oCOAutomation object reference</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>    <span class="k">Private</span> <span class="n">m_oCOAutomation</span> <span class="ow">As</span> <span class="kt">Object</span>
</code></pre></div>
<blockquote>
<p>CognosOfficeAutomationObject() Property Get statement</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>    <span class="c1">'Returns the instance of the Cognos Office Automation Object.</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">()</span>
    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">Handler</span><span class="p">:</span>

        <span class="c1">'Fetch the object if we don't have it yet.</span>
        <span class="k">If</span> <span class="n">m_oCOAutomation</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
            <span class="k">Set</span> <span class="n">m_oCOAutomation</span> <span class="o">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span>
        <span class="k">End</span> <span class="k">If</span>

        <span class="k">Set</span> <span class="n">CognosOfficeAutomationObject</span> <span class="o">=</span> <span class="n">m_oCOAutomation</span>

        <span class="k">Exit</span> <span class="k">Property</span>
    <span class="nf">Handler</span><span class="p">:</span>
        <span class="c1">'&lt;Place error handling here.  Remember you may not want to display a message box if you are running in a scheduled task&gt;</span>
    <span class="k">End</span> <span class="k">Property</span>
    <span class="n">Copy</span>
</code></pre></div>
<blockquote>
<p>Reporting() Property Get statement</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>    <span class="c1">'Returns the instance of the Cognos Office Automation Object.</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Reporting</span><span class="p">()</span>
    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">Handler</span><span class="p">:</span>

       <span class="c1">'Fetch the object if we don't have it yet.</span>
       <span class="k">If</span> <span class="n">m_oCAFE</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span>
           <span class="k">Set</span> <span class="n">m_oCAFE</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">)</span>
       <span class="k">End</span> <span class="k">If</span>

       <span class="k">Set</span> <span class="n">Reporting</span> <span class="o">=</span> <span class="n">m_oCAFE</span>

       <span class="k">Exit</span> <span class="k">Property</span>
    <span class="nf">Handler</span><span class="p">:</span>
       <span class="n">MsgBox</span> <span class="s">"Error"</span>
       <span class="c1">'&lt;Place error handling here.  Remember you may not want to display a message box if you are running in a scheduled task&gt;</span>
    <span class="k">End</span> <span class="k">Property</span>
</code></pre></div>
<p>The references mentioned in this section can be imported via the CognosOfficeAutomationExample.bas file. It is good practice to double-check that the file contains all of references. If the CognosOfficeAutomationExample.bas file is missing any references, you can add these references to the file yourself.</p>

<aside class="notice">
Ensure that both object references are initialized before using IBM Planning Analytics for Microsoft Excel API.
</aside>

<p><img src="images/api_references-0ba62869.jpg" title="CognosOfficeAutomationExample.bas file" alt="alt text" /></p>
<h1 id='common-view-specification-schema'>Common View Specification Schema</h1>
<blockquote>
<p>The following is the schema for the Common View Specification</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="o">/*</span><span class="p">!</span>
 <span class="o">*</span> <span class="n">Licensed</span> <span class="n">Materials</span> <span class="o">-</span> <span class="k">Property</span> <span class="nf">of</span> <span class="n">IBM</span>
 <span class="o">*</span> <span class="err">©</span> <span class="n">IBM</span> <span class="n">Corp</span><span class="p">.</span> <span class="err">2021.</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span><span class="p">.</span>
 <span class="err">*</span> <span class="n">US</span> <span class="n">Government</span> <span class="n">Users</span> <span class="n">Restricted</span> <span class="n">Rights</span> <span class="o">-</span> <span class="n">Use</span><span class="p">,</span> <span class="n">duplication</span> <span class="n">or</span>
 <span class="o">*</span> <span class="n">disclosure</span> <span class="n">restricted</span> <span class="n">by</span> <span class="n">GSA</span> <span class="n">ADP</span> <span class="n">Schedule</span> <span class="n">Contract</span> <span class="n">with</span> <span class="n">IBM</span> <span class="n">Corp</span><span class="p">.</span>
 <span class="err">*/</span>

<span class="err">{</span>
    <span class="err">"$</span><span class="n">schema</span><span class="s">": "</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">json</span><span class="o">-</span><span class="n">schema</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">draft</span><span class="o">-</span><span class="mi">06</span><span class="o">/</span><span class="n">schema#</span><span class="s">",
    "</span><span class="n">title</span><span class="s">": "</span><span class="n">IBM</span> <span class="n">Planning</span> <span class="n">Analytics</span> <span class="n">Universal</span> <span class="n">View</span> <span class="n">Specification</span><span class="s">",
    "</span><span class="n">type</span><span class="s">": "</span><span class="n">object</span><span class="s">",
    "</span><span class="n">required</span><span class="s">": ["</span><span class="n">MDX</span><span class="s">"],
    "</span><span class="n">additionalProperties</span><span class="s">": false,
    "</span><span class="n">properties</span><span class="s">": {
        "</span><span class="n">MDX</span><span class="s">": {
            "</span><span class="n">type</span><span class="s">": "</span><span class="n">string</span><span class="s">"
        },
        "</span><span class="n">Meta</span><span class="s">": {
            "</span><span class="n">type</span><span class="s">": "</span><span class="n">object</span><span class="s">",
            "</span><span class="n">additionalProperties</span><span class="s">": true,
            "</span><span class="n">properties</span><span class="s">": {
                "</span><span class="n">Aliases</span><span class="s">": {
                    "</span><span class="n">type</span><span class="s">": "</span><span class="n">object</span><span class="s">",
                    "</span><span class="n">additionalProperties</span><span class="s">": false,
                    "</span><span class="n">patternProperties</span><span class="s">": {
                        "</span><span class="o">^\\</span><span class="err">[</span><span class="p">.</span><span class="err">+\\]\\.\\[.+\\]$":</span> <span class="err">{</span>
                            <span class="err">"</span><span class="n">type</span><span class="s">": "</span><span class="n">string</span><span class="s">"
                        }
                    }
                },
                "</span><span class="n">ExpandAboves</span><span class="s">": {
                    "</span><span class="n">type</span><span class="s">": "</span><span class="n">object</span><span class="s">",
                    "</span><span class="n">additionalProperties</span><span class="s">": false,
                    "</span><span class="n">patternProperties</span><span class="s">": {
                        "</span><span class="o">^\\</span><span class="err">[</span><span class="p">.</span><span class="err">+\\]\\.\\[.+\\]$":</span> <span class="err">{</span>
                            <span class="err">"</span><span class="n">type</span><span class="s">": "</span><span class="n">boolean</span><span class="s">"
                        }
                    }
                },
                "C</span><span class="n">ontextSets</span><span class="s">": {
                    "</span><span class="n">type</span><span class="s">": "</span><span class="n">object</span><span class="s">",
                    "</span><span class="n">additionalProperties</span><span class="s">": false,
                    "</span><span class="n">patternProperties</span><span class="s">": {
                        "</span><span class="o">^\\</span><span class="err">[</span><span class="p">.</span><span class="err">+\\]\\.\\[.+\\]$":</span> <span class="err">{</span>
                            <span class="err">"</span><span class="n">type</span><span class="s">": "</span><span class="n">object</span><span class="s">",
                            "</span><span class="n">additionalProperties</span><span class="s">": false,
                            "</span><span class="n">properties</span><span class="s">": {
                                "</span><span class="n">Expression</span><span class="s">": {
                                    "</span><span class="n">type</span><span class="s">": "</span><span class="n">string</span><span class="s">"
                                },
                                "</span><span class="n">SubsetName</span><span class="s">": {
                                    "</span><span class="n">type</span><span class="s">": "</span><span class="n">string</span><span class="s">"
                                },
                                "</span><span class="n">IsPublic</span><span class="s">": {
                                    "</span><span class="n">type</span><span class="s">": "</span><span class="n">boolean</span><span class="s">"
                                }
                            },
                            "</span><span class="n">oneOf</span><span class="s">": [
                                {
                                    "</span><span class="n">required</span><span class="s">": ["</span><span class="n">Expression</span><span class="s">"]
                                },
                                {
                                    "</span><span class="n">required</span><span class="s">": ["</span><span class="n">SubsetName</span><span class="s">"]
                                }
                            ],
                            "</span><span class="n">dependencies</span><span class="s">": {
                                "</span><span class="n">IsPublic</span><span class="s">": "</span><span class="n">SubsetName</span><span class="s">"
                            }
                        }
                    }
                }
            }
        }
    }
}
</span></code></pre></div>
<p>You can use a Common View Specification to embed additional state information in your Exploration View or Quick Report.</p>

<p>A Common View Specification (CVS) is a JSON that can be used to embed additional state information when creating an Exploration View or Quick Report. A CVS is composed of two major parts; the MDX query and a sidecar for additional state information. Data driven mechanisms, such as TurboIntegrator are only concerned with the MDX query, however user interfaces will also consume the sidecar to ensure presentation consistency. By using a CVS, you can generate highly customizable Exploration Views or Quick Reports. For example, using a CVS, you can define aliases and subsets as per the CVS schema input.</p>

<p>To generate an Exploration View or Quick Report from a CVS, use the CreateFromCVS API method. For more information, see <a href="#createfromcvs-exploration">CreateFromCVS (Exploration)</a> and <a href="#createfromcvs-quick-report">CreateFromCVS (Quick Report)</a>.</p>
<h1 id='global-api-functions'>Global API functions</h1>
<p>Global API functions can be used to interact with any IBM Planning Analytics for Microsoft Excel worksheets. The global functions that are exposed through the IBM Cognos® automation objects are:</p>
<h2 id='getconnection'>GetConnection</h2>
<p>GetConnection is a method exposed by the top level reporting API object. If you want to use the REST APIs, you&#39;ll need to use the GetConnection method to return the connection object that implements the REST request methods (GET, POST, DELETE, PATCH) and communicate with the TM1 Server.</p>

<p>To learn more about REST request methods, see <a href="#rest-api">REST API</a>.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the GetConnection method. 
To use the method, you must know the URL of the host that you want to send REST requests to.
<code>Reporting.GetConnection(&lt;CURRENT&gt;)</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to send REST requests to.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='changedatasource-task-pane'>ChangeDataSource (Task Pane)</h2>
<p>You can use the ChangeDataSource method to change datasources within a session. You might be prompted for a login if you weren&#39;t logged in. </p>
<h3 id='syntax-2'>Syntax</h3>
<p>Reporting.TaskPane.ChangeDatasource &quot;host system URL&quot; &quot;server name&quot;</p>
<h2 id='clearalldata'>ClearAllData</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">ClearAllData</span> 
</code></pre></div>
<p>ClearAllData clears all data values in the opened workbooks.</p>
<h3 id='syntax-3'>Syntax</h3>
<p>The following string is the syntax for the ClearAllData method.</p>

<p><code>ClearAllData()</code></p>
<h2 id='clearbook'>ClearBook</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">ClearBook</span>
</code></pre></div>
<p>ClearBook clears Planning Analytics for Microsoft Excel data in the active book.</p>
<h3 id='syntax-4'>Syntax</h3>
<p>The following string is the syntax for the ClearBook method.</p>

<p><code>ClearBook()</code></p>
<h2 id='clearcache'>ClearCache</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">ClearCache</span><span class="p">()</span>
</code></pre></div>
<p>ClearCache reduces the size of an IBM® Planning Analytics for Microsoft Excel workbook by clearing metadata and data from formulas.</p>
<h3 id='syntax-5'>Syntax</h3>
<p>The following string is the syntax for the ClearCache method.</p>

<p><code>ClearCache()</code></p>
<h2 id='clearselection'>ClearSelection</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">ClearSelection</span>
</code></pre></div>
<p>ClearSelection clears IBM Planning Analytics for Microsoft Excel data in the active selection.</p>
<h3 id='syntax-6'>Syntax</h3>
<p>The following string is the syntax for the ClearSelection method.</p>

<p><code>ClearSelection()</code></p>
<h2 id='clearsheet'>ClearSheet</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">ClearSheet</span>
</code></pre></div>
<p>ClearSheet clears IBM Planning Analytics for Microsoft Excel data in the active sheet.</p>
<h3 id='syntax-7'>Syntax</h3>
<p>The following string is the syntax for the ClearSheet method.</p>

<p><code>ClearSheet()</code></p>
<h2 id='hide-task-pane'>Hide (Task Pane)</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Hide</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>You can use the Hide method to hide the Task Pane. </p>
<h3 id='syntax-8'>Syntax</h3>
<p>The following is the syntax for the Hide method.</p>

<p><code>Reporting.TaskPane.Hide()</code></p>
<h2 id='httplogoncredentials'>HttpLogonCredentials</h2>
<p>The HttpLogonCredentials function authenticates a user to a Web site that requires new authentication credentials, such as Basic, Kerberos, and SiteMinder. HttpLogonCredentials takes the URL, user name, and password that are used for authentication on the Web site.</p>
<h3 id='syntax-9'>Syntax</h3>
<p>IBM® Cognos® does not support SiteMinder form-based authentication. You must use the IBM Cognos menu commands and options instead of the API to automate the refreshing and publishing of content.</p>

<p><code>HttpLogonCredentials (url, user name, password)</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>The URL for the Web site against which you want to authenticate.</td>
<td>String</td>
</tr>
<tr>
<td>user name</td>
<td>The user name for authentication.</td>
<td>String</td>
</tr>
<tr>
<td>password</td>
<td>The password for authentication.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='isvisible-task-pane'>IsVisible (Task Pane)</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Refresh</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>You can use the IsVisible method to return the state of the Task Pane. If True is returned, the Task Pane is visible. If False is returned, the Task Pane is not visible.</p>
<h3 id='syntax-10'>Syntax</h3>
<p>The following is the syntax for the IsVisible method.</p>

<p><code>Reporting.TaskPane.IsVisible()</code></p>
<h2 id='logoff'>Logoff</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logoff</span>
</code></pre></div>
<p>Logoff logs off all the IBM® Cognos® servers to which users are currently logged on.</p>
<h3 id='syntax-11'>Syntax</h3>
<p>The following string is the syntax for the Logoff method.</p>

<p><code>Logoff()</code></p>
<h2 id='logon'>Logon</h2>
<blockquote>
<p>Example of the syntax for logging into an IBM Cognos Analytics system: </p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example of the syntax for logging into an IBM TM1 system: </p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://myPlanningAnalyticsServer.com"</span><span class="p">,</span>
<span class="s">"admin"</span><span class="p">,</span> <span class="s">"peaches"</span><span class="p">,</span> <span class="s">"localhost/Planning Sample"</span><span class="p">)</span>
</code></pre></div>
<p>The Logon function takes the URL of the server and the credential elements required by IBM® Planning Analytics for Microsoft Excel to perform a logon: user ID, password, and namespace. The namespace parameter is case-sensitive; therefore, you must match the namespace exactly. Planning Analytics for Microsoft Excel uses the Logon function, whether you&#39;re logging into an IBM Cognos Analytics system or an IBM TM1 system.</p>

<p>IBM Cognos® Office stores user credentials only in memory. For this reason, users are responsible for storing their credentials in a secured area and passing them to the logon methods at run time.</p>

<p>If you use the Logon function with incorrect credentials, the system raises a CAMException error, however, no exception is written to the log file indicating a failure. To avoid this situation, remember that strings are case-sensitive and ensure that you use valid user IDs, passwords, and namespaces.</p>

<p>Logon does not appear in the macro list in the Microsoft application because the macro receives an argument. Any macro with parameters is by definition private and private macros are not shown in the macro options by default.</p>

<aside class="notice">
The Logon function cannot be used to log into a cloud-based system.
</aside>
<h3 id='syntax-12'>Syntax</h3>
<p>The following string is the syntax for the Logon method.</p>

<p><code>Boolean Logon (url, user name, password, namespace)</code></p>
<h3 id='arguments-3'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>The URL for the IBM Cognos Analytics or IBM TM1 system, which you want to log on to.</td>
<td>String</td>
</tr>
<tr>
<td>user name</td>
<td>The user name for authentication.</td>
<td>String</td>
</tr>
<tr>
<td>password</td>
<td>The password for authentication.</td>
<td>String</td>
</tr>
<tr>
<td>namespace</td>
<td>The specific namespace for authentication.</td>
<td>String</td>
</tr>
</tbody></table>

<aside class="notice">
Mode 1 authentication requires the combination of the PM Hub host and the TM1 Server as the namespace, separated by a forward slash (/). If your namespace contains a forward slash, the logon is interpreted as a Mode 1 authentication attempt.
</aside>
<h3 id='return-value'>Return value</h3>
<p>Data type: Boolean</p>

<p>The Boolean value is true if successful</p>
<h2 id='publish'>Publish</h2>
<blockquote>
<p>Example of the syntax for publishing to a IBM Cognos Analytics data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Publish</span><span class="p">(</span><span class="s">"CAMID('::Anonymous')/folder[@name='My
Folders']"</span><span class="p">,</span><span class="s">"Description of 'My Folders'"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Example of the syntax for publishing to a IBM Planning Analytics data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="p">(</span><span class="s">"https://myPAconnection.PlanningAnalytics.com"</span><span class="p">,</span> <span class="s">"C:\path\to\local\file.xlsx"</span><span class="p">,</span> <span class="s">"/tm1/Planning%20Sample/api/v1/Contents('Applications')/Contents('Planning %20Sample')"</span><span class="p">,</span> <span class="s">"PublishedFileName.xlsx"</span><span class="p">,</span> <span class="s">"My Description"</span><span class="p">,</span> <span class="s">"MyToolTip"</span><span class="p">)</span>
</code></pre></div>
<p>Use Publish to publish content to IBM® Cognos® Connection or to a TM1 Server Application Folder. </p>
<h3 id='syntax-13'>Syntax</h3>
<p>The arguments mirror the entry boxes in the dialog box that is used in the user interface.</p>

<p>Publish does not appear in the macro list in the Microsoft application because the macro receives an argument. Any macro with parameters is by definition private and private macros are not shown in the macro options by default.</p>

<p><code>Publish (url, document path, server path, name, description, screenTip)</code></p>
<h3 id='arguments-4'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>The server to which you are publishing.</td>
<td>String</td>
</tr>
<tr>
<td>document path</td>
<td>The location of the document to be published. It is the local path of the file that you want to publish. If the path of your folder is not correct when you publish using automation, you are again prompted to log on. This is because IBM Cognos does not distinguish between non-existing folders and folders for which the user does not have permissions. This security feature helps to prevent the discovery of the folder path by trial and error.</td>
<td></td>
</tr>
</tbody></table>

<p>In IBM Cognos Analytics, the folder path is a search path. For more information, see the IBM Cognos Analytics Administration Guide. | String
server path | The path in the content store where the document is saved. | String
name | The document name that will appear in IBM Cognos. | String
description | The document description that will appear in IBM Cognos. | String
screenTip | The text that users see when they point to the document in IBM Cognos. | String</p>
<h2 id='publishtm1'>PublishTm1</h2>
<blockquote>
<p>Example for publishing to a TM1 data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">PublishTm1</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Dim</span> <span class="nv">sUrl</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="s">"http://myserver.ibm.com"</span>
    <span class="k">Dim</span> <span class="nv">sDS</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDS</span> <span class="o">=</span> <span class="s">"Planning Sample"</span>
    <span class="k">Dim</span> <span class="nv">sPublishPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sPublishPath</span> <span class="o">=</span> <span class="s">"Contents('Planning Sample')/Contents('Top Down Goals')"</span>
    <span class="k">Dim</span> <span class="nv">sDocumentPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDocumentPath</span> <span class="o">=</span> <span class="s">"C:\Users\JC\Documents\Publish API book.xlsx"</span>
    <span class="k">Dim</span> <span class="nv">sName</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sName</span> <span class="o">=</span> <span class="s">"Publish&amp;Tm1 test1"</span>
    <span class="k">Dim</span> <span class="nv">sDescription</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDescription</span> <span class="o">=</span> <span class="s">"New PublishTm1 api"</span>
    <span class="k">Dim</span> <span class="nv">sScreenTip</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sScreenTip</span> <span class="o">=</span> <span class="s">"test"</span>
    <span class="k">Dim</span> <span class="nv">sIsPrivate</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">sIsPrivate</span> <span class="o">=</span> <span class="k">True</span>
    <span class="k">Dim</span> <span class="nv">sAsReference</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">sAsReference</span> <span class="o">=</span> <span class="k">False</span>

    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">PublishTm1</span> <span class="n">sUrl</span><span class="p">,</span> <span class="n">sDS</span><span class="p">,</span> <span class="n">sPublishPath</span><span class="p">,</span> <span class="n">sDocumentPath</span><span class="p">,</span> <span class="n">sName</span><span class="p">,</span> <span class="n">sDescription</span><span class="p">,</span> <span class="n">sScreenTip</span><span class="p">,</span> <span class="n">sIsPrivate</span><span class="p">,</span> <span class="n">sAsReference</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">Sub</span> 
</code></pre></div>
<p>PublishTm1 is a TM1-specific API that differs from the existing <em>Publish</em> api in the following ways:
- No need to include <code>/tm1/Planning%20Sample/api/v1/Contents(&#39;Applications&#39;)/</code> in the publish path; the API fills that in during execution.
- No need to encode spaces and other special characters.
- Takes a Boolean argument to control publish scope (public/private).
- Takes a Boolean argument to publish as reference.</p>
<h3 id='syntax-14'>Syntax</h3>
<p><code>PublishTm1(string serverURL, string serverName, string publishPath, string documentPath, string name, string description, string screenTip, bool isPrivate, bool asReference)</code></p>
<h2 id='makefoldertm1'>MakeFolderTm1</h2>
<blockquote>
<p>Example for creating a public or private folder at a given location:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">MakeFolderTm1</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span> 
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Dim</span> <span class="nv">sUrl</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="s">"http://ablauts1.fyre.ibm.com"</span>
    <span class="k">Dim</span> <span class="nv">sDS</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDS</span> <span class="o">=</span> <span class="s">"Planning Sample"</span>
    <span class="k">Dim</span> <span class="nv">sFolderPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sFolderPath</span> <span class="o">=</span> <span class="s">"Contents('Planning Sample')/Contents('Top Down Goals')"</span>
    <span class="k">Dim</span> <span class="nv">sFolderName</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sFolderName</span> <span class="o">=</span> <span class="s">"PublishTm1_Folder1"</span>
    <span class="k">Dim</span> <span class="nv">sIsPrivate</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">sIsPrivate</span> <span class="o">=</span> <span class="k">False</span>

    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">MakeFolderTm1</span> <span class="n">sUrl</span><span class="p">,</span> <span class="n">sDS</span><span class="p">,</span> <span class="n">sFolderPath</span><span class="p">,</span> <span class="n">sFolderName</span><span class="p">,</span> <span class="n">sIsPrivate</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">Sub</span> 
</code></pre></div>
<p>MakeFolderTm1 is a TM1-specific API that can create a public or private folder at a given location and differs from the existing <em>Publish</em> api in the following ways:
- No need to include <code>/tm1/Planning%20Sample/api/v1/Contents(&#39;Applications&#39;)/</code> in the publish path; the API fills that in during execution.
- No need to encode spaces and other special characters.
- Takes a Boolean argument to control publish scope (public/private).</p>
<h3 id='syntax-15'>Syntax</h3>
<p><code>MakeFolderTm1(string serverURL, string serverName, string folderPath, string folderName, bool isPrivate)</code></p>
<h2 id='publishtm1multiple'>PublishTm1Multiple</h2>
<blockquote>
<p>Example for publishing multiple files to a TM1 data source:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">PublishTm1Multiple</span><span class="p">()</span>
<span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">HANDLER</span>
    <span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span>
        <span class="c1">'Use the message suppressor to turn off all Cognos Office messages.</span>
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>
    <span class="k">Dim</span> <span class="nv">sUrl</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sUrl</span> <span class="o">=</span> <span class="s">"http://ablauts1.fyre.ibm.com"</span>
    <span class="k">Dim</span> <span class="nv">sDS</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDS</span> <span class="o">=</span> <span class="s">"Planning Sample"</span>
    <span class="k">Dim</span> <span class="nv">sPublishPath</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sPublishPath</span> <span class="o">=</span> <span class="s">"Contents('Planning Sample')/Contents('Top Down Goals')"</span>
    <span class="k">Dim</span> <span class="nv">sDocumentPaths</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDocumentPaths</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"C:\Users\JC\Documents\Publish API testbook.xlsx, C:\Users\JC\Documents\4420.xlsx"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sNames</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sNames</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"Publish Multiple test 1,Publish Multiple test 2"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sDescriptions</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sDescriptions</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"A test of the new PublishTm1 api"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sScreenTips</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">sScreenTips</span><span class="p">()</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="s">"A test"</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">sIsPrivate</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="c1">'To publish with a private scope set this to true</span>
    <span class="n">sIsPrivate</span> <span class="o">=</span> <span class="k">True</span>
    <span class="k">Dim</span> <span class="nv">sAsReference</span> <span class="ow">As</span> <span class="kt">Boolean</span>
        <span class="c1">'To publish the file as a reference set this to true</span>
    <span class="n">sAsReference</span> <span class="o">=</span> <span class="k">False</span>

        <span class="c1">'Call the Cognos Office Automation object to publish the file.  </span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">PublishTm1Multiple</span> <span class="n">sUrl</span><span class="p">,</span> <span class="n">sDS</span><span class="p">,</span> <span class="n">sPublishPath</span><span class="p">,</span> <span class="n">sDocumentPaths</span><span class="p">,</span> <span class="n">sNames</span><span class="p">,</span> <span class="n">sDescriptions</span><span class="p">,</span> <span class="n">sScreenTips</span><span class="p">,</span> <span class="n">sIsPrivate</span><span class="p">,</span> <span class="n">sAsReference</span>
    <span class="k">Exit</span> <span class="k">Sub</span>
    <span class="nf">HANDLER</span><span class="p">:</span>  
<span class="k">End</span> <span class="k">Sub</span> 
</code></pre></div>
<p>PublishTm1Multiple is a TM1-specific API that is an expansion on the <em>PublishTm1</em> api, which allows a list of files to be published at once to the same location with the same scope. <em>PublishTm1Multiple</em> differs from the existing <em>Publish</em> api in the following ways:
- No need to include <code>/tm1/Planning%20Sample/api/v1/Contents(&#39;Applications&#39;)/</code> in the publish path; the API fills that in during execution.
- No need to encode spaces and other special characters.
- Takes a string array of file locations and names (must be a 1-to-1 pairing of files and file names).
- Takes a string array of descriptions and screentips. If these aren’t provided API defaults to an empty string.
- Takes a Boolean argument to control publish scope (public/private).
- Takes a Boolean argument to publish as reference.
- Publish location, scope, and as reference settings are applied to all the files in the array.</p>
<h3 id='syntax-16'>Syntax</h3>
<p><code>PublishTm1Multiple(string serverURL, string serverName, string publishPath, string[] documentPaths, string[] names, string[] descriptions, string[] screenTips, bool isPrivate, bool asReference)</code></p>
<h2 id='refresh-task-pane'>Refresh (Task Pane)</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Refresh</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>You can use the Refresh method to refresh the metadata tree in the Task Pane. </p>
<h3 id='syntax-17'>Syntax</h3>
<p>The following is the syntax for the Refresh method.</p>

<p><code>Reporting.TaskPane.Refresh()</code></p>
<h2 id='refreshalldata'>RefreshAllData</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="n">as</span> <span class="kt">Boolean</span>
<span class="n">Copy</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>
<span class="n">Copy</span>

<span class="c1">'Refresh the data if we successfully logged on to the</span>
<span class="n">IBM</span> <span class="n">Cognos</span> <span class="n">server</span><span class="p">.</span>
<span class="n">Copy</span>

<span class="k">If</span> <span class="n">bResult</span> <span class="k">Then</span>
<span class="n">Copy</span>

  <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">RefreshAllData</span>
<span class="n">Copy</span>

<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>RefreshAllData fetches the most current data values from the IBM® TM1 server and updates those values in the current document. </p>
<h3 id='syntax-18'>Syntax</h3>
<p>The system must be successfully logged on to the IBM TM1 server.</p>

<p>If you are using IBM Cognos Office with IBM Cognos® Analytics data, ensure that the Prompt Update Method property on the Manage Data tab in the IBM Cognos pane is set to Use=Display or Do Not Update to complete the operation. Otherwise, the report cannot be refreshed without user intervention and generates errors.</p>

<p><code>RefreshAllData()</code></p>
<h2 id='refreshalldataandformat'>RefreshAllDataAndFormat</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="n">as</span> <span class="kt">Boolean</span>
<span class="n">Copy</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>
<span class="n">Copy</span>

<span class="c1">'Refresh the data and formatting if we successfully logged on to the</span>
<span class="n">IBM</span> <span class="n">Cognos</span> <span class="n">server</span><span class="p">.</span>
<span class="n">Copy</span>

<span class="k">If</span> <span class="n">bResult</span> <span class="k">Then</span>
<span class="n">Copy</span>

  <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">RefreshAllDataAndFormat</span>
<span class="n">Copy</span>

<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>RefreshAllDataAndFormat retrieves the most current data values and formatting from the IBM® Cognos® server and updates those values and formats in the current document.</p>
<h3 id='syntax-19'>Syntax</h3>
<p>The system must be successfully logged on to the IBM Cognos server.</p>

<p>If you are using IBM Cognos Office with IBM Cognos Analytics data, ensure that the <strong>Prompt Update Method</strong> property on the <strong>Manage Data</strong> tab in the IBM Cognos pane is set to <strong>Use=Display</strong> or <strong>Do Not Update</strong> to complete the operation. Otherwise, the report cannot be refreshed without user intervention and generates errors.</p>

<p><code>RefreshAllDataAndFormat()</code></p>
<h2 id='refreshbook'>RefreshBook</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshBook</span>
</code></pre></div>
<p>RefreshBook refreshes all data values in the opened workbooks.</p>
<h3 id='syntax-20'>Syntax</h3>
<p>The following string is the syntax for the RefreshBook method.</p>

<p><code>RefreshBook()</code></p>
<h2 id='refreshselection'>RefreshSelection</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshSelection</span>
</code></pre></div>
<p>RefreshSelection refreshes IBM Planning Analytics for Microsoft Excel data in the active selection. </p>
<h3 id='syntax-21'>Syntax</h3>
<p>The following string is the syntax for the RefreshSelection method.</p>

<p><code>RefreshSelection()</code></p>
<h2 id='refreshsheet'>RefreshSheet</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshSheet</span>
</code></pre></div>
<p>RefreshSheet refreshes IBM Planning Analytics for Microsoft Excel data in the active sheet. </p>
<h3 id='syntax-22'>Syntax</h3>
<p>The following string is the syntax for the RefreshSheet method.</p>

<p><code>RefreshSheet()</code></p>
<h2 id='settings'>Settings</h2>
<blockquote>
<p>Example using <code>SetValue</code></p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">SetValue</span> <span class="s">"GroupingOption"</span><span class="p">,</span> <span class="s">"Full"</span>
</code></pre></div>
<blockquote>
<p>Example using <code>GetValue</code></p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span> <span class="p">(</span><span class="s">"ShowServerInExploration"</span><span class="p">)</span>
</code></pre></div>
<p>The Settings function can be used to enable, disable, or define settings in Planning Analytics for Microsoft Excel. </p>
<h3 id='syntax-23'>Syntax</h3>
<p>SetValue is used to set a value in a setting.</p>

<p><code>Reporting.Settings.SetValue &quot;&lt;setting name&gt;&quot;, &quot;&lt;setting value&gt;&quot;</code></p>

<p>GetValue is used to retrieve a value of a setting.</p>

<p><code>Reporting.Settings.GetValue(&quot;&lt;setting name&gt;&quot;)</code></p>
<h3 id='arguments-5'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>setting name</td>
<td>The name of the setting that you want to enable, disable, or define.</td>
<td>Alphabetic</td>
</tr>
<tr>
<td>setting value</td>
<td>The value that you want to use to enable, disable, or define in the setting.</td>
<td>Alphabetic, alphanumeric, boolean, integer</td>
</tr>
</tbody></table>

<p>View Settings in the <a href="https://www.ibm.com/support/knowledgecenter/SSD29G_2.0.0/com.ibm.swg.ba.cognos.ug_cxr.2.0.0.doc/c_cognosofficereportingsettings.html">CognosOfficeReportingSettings.xml</a> file for a list of the possible settings and values that you can use.</p>
<h2 id='show-task-pane'>Show (Task Pane)</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="ow">As</span> <span class="kt">Boolean</span>
<span class="n">bResult</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">()</span>
<span class="k">If</span> <span class="n">bResult</span> <span class="o">=</span> <span class="k">True</span> <span class="k">Then</span>
<span class="k">Call</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">TaskPane</span><span class="p">.</span><span class="n">Show</span><span class="p">()</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>You can use the Show method to reveal the Task Pane. </p>
<h3 id='syntax-24'>Syntax</h3>
<p>The following is the syntax for the Show method.</p>

<p><code>Reporting.TaskPane.Show()</code></p>
<h2 id='suppressmessages'>SuppressMessages</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Class_Initialize</span><span class="p">()</span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">SuppressMessages</span> <span class="k">True</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Class_Terminate</span><span class="p">()</span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">SuppressMessages</span> <span class="k">False</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>When added to an existing script or function in the Planning Analytics for Microsoft Excel API, SuppressMessages suppresses all of the messages and dialog boxes that may arise from the script or function.</p>

<p>In addition to SuppressMessage, you need to set the Application.DisplayAlerts property in Microsoft Excel to <code>false</code>. For more information about the Application.DisplayAlerts property, see <a href="https://docs.microsoft.com/en-us/office/vba/api/excel.application.displayalerts">Application.DisplayAlerts property</a>.</p>
<h3 id='syntax-25'>Syntax</h3>
<p>The following string is the syntax for the SuppressMessages method.</p>

<p><code>SuppressMessages()</code></p>
<h2 id='traceerror'>TraceError</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">TraceError</span><span class="p">(</span><span class="s">"VBA method failed"</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>The following is an example of the appended error information in the IBM Planning Analytics for Microsoft Excel log file:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="err">[</span><span class="n">Severity</span><span class="o">=</span><span class="k">Error</span><span class="err">]</span>
<span class="err">[</span><span class="n">Exception</span><span class="err">]</span> <span class="n">TraceError</span><span class="p">(</span><span class="kt">String</span> <span class="n">error</span><span class="p">)</span>
<span class="err">[</span><span class="n">Thread</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">Background</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">Pool</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">Domain</span><span class="o">=</span><span class="err">]</span>
<span class="err">[</span><span class="n">System</span><span class="p">.</span><span class="n">Exception</span><span class="err">]</span> <span class="n">VBA</span> <span class="n">API</span> <span class="n">ERROR</span><span class="p">:</span> <span class="n">VBA</span> <span class="n">method</span> <span class="n">failed</span>
</code></pre></div>
<p>TraceError appends error information into the IBM Planning Analytics for Microsoft Excel log file. The user defines the error information they wish to append to the log file for errors.</p>
<h3 id='syntax-26'>Syntax</h3>
<p>The following string is the syntax for the TraceError method.</p>

<p><code>TraceError(&quot;&lt;user defined error information&gt;&quot;)</code></p>
<h2 id='tracelog'>TraceLog</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">strTraceLog</span> <span class="n">as</span> <span class="kt">String</span>
<span class="n">strTraceLog</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">TraceLog</span>
<span class="n">MsgBox</span> <span class="n">strTraceLog</span>
</code></pre></div>
<p>TraceLog returns all the automation activities and errors.</p>
<h3 id='syntax-27'>Syntax</h3>
<p>The following string is the syntax for the TraceLog  method.</p>

<p><code>*String* TraceLog ()</code></p>
<h3 id='return-value-2'>Return Value</h3>
<p>Data type: String</p>

<p>The value of the logging item as string</p>
<h2 id='unlinkalldata'>UnlinkAllData</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">UnlinkAllData</span>
</code></pre></div>
<p>UnlinkAllData disconnects all the IBM® Cognos® data values in the current document. The values are no longer updated with subsequent calls to RefreshAllData. The values become static. </p>
<h3 id='syntax-28'>Syntax</h3>
<p>For IBM Cognos Office, any IBM Cognos data values that are imported into the current document after UnlinkAllData is called will continue to be linked to the IBM Cognos data source.</p>

<p>The values can be updated with new server data using the RefreshAllData call.</p>

<p><code>UnlinkAllData ()</code></p>
<h2 id='unlinkbook'>UnlinkBook</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">UnlinkBook</span> 
</code></pre></div>
<p>UnlinkBook unlinks the active book from the connection.</p>
<h3 id='syntax-29'>Syntax</h3>
<p>The following string is the syntax for the UnlinkBook method.</p>

<p><code>UnlinkBook()</code></p>
<h2 id='unlinkselection'>UnlinkSelection</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">UnlinkSelection</span>
</code></pre></div>
<p>UnlinkSelection disconnects the selected data values. The values are no longer updated with subsequent calls to Refreshable. The values become static.</p>
<h3 id='syntax-30'>Syntax</h3>
<p>The following string is the syntax for the UnlinkSelection method.</p>

<p><code>UnlinkSelection()</code></p>
<h2 id='unlinksheet'>UnlinkSheet</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">UnlinkSheet</span> 
</code></pre></div>
<p>UnlinkSheet unlinks the active sheet from the connection.</p>
<h3 id='syntax-31'>Syntax</h3>
<p>The following string is the syntax for the UnlinkSheet  method.</p>

<p><code>UnlinkSheet()</code></p>
<h2 id='updateserverurl'>UpdateServerUrl</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">UpdateServerUrl</span> <span class="s">"http://testserver1/cgi-bin/cognos.cgi"</span> 
<span class="s">"http://prodserver1/cgi-bin/cognos.cgi"</span>
</code></pre></div>
<blockquote>
<p>The following example uses only the part of the URL that is changing:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">UpdateServerUrl</span> <span class="s">"testserver1"</span> <span class="s">"prodserver1"</span>
</code></pre></div>
<p>Use UpdateServerUrl to update the IBM® Cognos® server information for existing reports and formulas. </p>
<h3 id='syntax-32'>Syntax</h3>
<p>The UpdateServerUrl method takes two arguments: the old server URL and the new server URL. These arguments mirror the entry boxes in the <strong>Update System</strong> dialog box. To gain access to this control from IBM Cognos, click the <strong>Options</strong> button on the IBM Cognos ribbon, then click <strong>Update System Utility</strong>.</p>

<p>The UpdateServerUrl method replaces the server information for existing reports. When running this command, the name of the package or data source remains the same. You can use this method to change only one server, such as a test server to a production server. The URL arguments can be full or partial URLs. If any argument is empty, this command does nothing, however, running this command with empty arguments has the potential to corrupt the report. Server information is stored in both the server property and the serialized report property. Running an empty command could cause these two instances to get out of sync.</p>

<p>Because the UpdateServerUrl method searches and replaces strings, it is possible to use only part of the URL, provided it is a unique substring. </p>

<aside class="notice">
The UpdateServerUrl search looks at all data in the workbook and updates data that matches the search string, not just report properties containing the URL string. Therefore, when you use only part or all of the original URL string with the UpdateServerUrl method, you will change all data that matches the search string.
</aside>

<p><code>UpdateServerUrl &quot;old server URL string&quot; &quot;new server URL string&quot;</code></p>
<h3 id='arguments-6'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>old server URL string</td>
<td>Indicates the URL of the source or current system.</td>
<td>String</td>
</tr>
<tr>
<td>new server URL string</td>
<td>Indicates the URL of the target system.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='useragent'>UserAgent</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>  <span class="k">Dim</span> <span class="nv">useragent</span> <span class="n">as</span> <span class="kt">String</span>
  <span class="n">useragent</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">UserAgent</span>
</code></pre></div>
<p>Returns the product and build version details. For example, <code>PAfE/2.0.66.9 (8590999552); Excel/16.0.13127</code>.</p>
<h3 id='syntax-33'>Syntax</h3>
<p>The following string is the syntax for the UserAgent method. 
<code>Reporting.UserAgent</code></p>
<h2 id='useragentscrelease'>UserAgentSCRelease</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>  <span class="k">Dim</span> <span class="nv">release</span> <span class="n">as</span> <span class="kt">String</span>
  <span class="n">release</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">UserAgentSCRelease</span>
</code></pre></div>
<p>Returns the condensed product version details. For example, <code>66.9</code>.</p>
<h3 id='syntax-34'>Syntax</h3>
<p>The following string is the syntax for the UserAgentSCRelease method.
<code>Reporting.UserAgentSCRelease</code></p>
<h2 id='useragentscreleasefull'>UserAgentSCReleaseFull</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code>  <span class="k">Dim</span> <span class="nv">releasefull</span> <span class="n">as</span> <span class="kt">String</span>
  <span class="n">releasefull</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">UserAgentSCReleaseFull</span>
</code></pre></div>
<p>Returns the full product version details. For example, <code>2.0.66.9</code>.</p>
<h3 id='syntax-35'>Syntax</h3>
<p>The following string is the syntax for the UserAgentSCReleaseFull method.
<code>Reporting.UserAgentSCReleaseFull</code></p>
<h2 id='wait'>Wait</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">Wait</span>
</code></pre></div>
<blockquote>
<p>Usage example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Sub</span> <span class="nf">Wait</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">).</span><span class="n">Commit</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Wait</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">).</span><span class="n">Refresh</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Sub</span> <span class="nf">Wait</span><span class="p">()</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">RefreshBook</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">COMAddIns</span><span class="p">(</span><span class="s">"CognosOffice12.Connect"</span><span class="p">).</span><span class="n">Object</span><span class="p">.</span><span class="n">AutomationServer</span><span class="p">.</span><span class="n">Application</span><span class="p">(</span><span class="s">"COR"</span><span class="p">,</span> <span class="s">"1.1"</span><span class="p">).</span><span class="n">Wait</span>
    <span class="n">MsgBox</span> <span class="s">"Refresh complete!"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Wait holds the VBA thread until all prior IBM Planning Analytics for Microsoft Excel background tasks are complete. </p>
<h3 id='syntax-36'>Syntax</h3>
<p>The following string is the syntax for the Wait method.</p>

<p><code>Wait()</code></p>
<h1 id='exploration-api-functions'>Exploration API functions</h1>
<p>Exploration functions can be used to interact with exploration worksheets. </p>

<p>Exploration functions can use the following PropertyAccessor objects:</p>

<table><thead>
<tr>
<th>PropertyAccessor</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Count</td>
<td>Counts the number of Explorations in active book.</td>
</tr>
<tr>
<td>GetAt(sheet)</td>
<td>Gets the Exploration object on the specified sheet name, from the active book, if it exists.</td>
</tr>
<tr>
<td>GetReports()</td>
<td>Gets the collection of Exploration objects from the active book.</td>
</tr>
</tbody></table>

<p>The Exploration functions that are exposed through the IBM® Cognos® automation objects are:</p>
<h2 id='clear-exploration'>Clear (Exploration)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Clear</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">Clear</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Clear is used to clear all of the data values in the exploration.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the Clear method.</p>

<p><code>Reporting.Explorations.GetAt().Clear</code></p>
<h2 id='create-exploration'>Create (Exploration)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Create</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">create</span> <span class="s">"http://computername"</span><span class="p">,</span> <span class="s">"Planning Sample"</span><span class="p">,</span> 
    <span class="s">"plan_BudgetPlan"</span><span class="p">,</span> <span class="s">"Goal Input"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Create generates an Exploration View based on the host system URL, server name, cube name, and view name.</p>
<h3 id='syntax-2'>Syntax</h3>
<p>The following string is the syntax for the Create method.</p>

<p><code>Explorations.Create &quot;&lt;host system URL&gt;&quot;, &quot;&lt;server name&gt;&quot;, &quot;&lt;cube name&gt;&quot;, &quot;&lt;view name&gt;&quot;</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Exploration View is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Exploration View is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>cube name</td>
<td>Name of the cube which the Exploration View is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>view name</td>
<td>Name of the view which the Exploration View is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h2 id='createfromcvs-exploration'>CreateFromCVS (Exploration)</h2>
<blockquote>
<p>Example of the syntax for updating the common view specification of a report:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">CreateFromCVS</span><span class="p">(</span><span class="s">"http://server-example.ibm.com"</span><span class="p">,</span> <span class="s">"Planning Sample"</span><span class="p">,</span> 
<span class="p">{</span>
  <span class="s">"MDX"</span><span class="p">:</span> <span class="s">"SELECT {([d1].[h1].[line 2],[d3].[h1].[2004]),([d1].[h1].[line 2],[d3].[h1].[Q1-2004]),([d1].[h1].[line 2],[d3].[h1].[Jan-2004])}  DIMENSION PROPERTIES MEMBER_UNIQUE_NAME, LEVEL_NUMBER, CHILDREN_CARDINALITY ON 0  FROM [my_Cube] WHERE ( [d2].[h1].[toys], [d4].[h1].[USD], [d5].[h1].[Sales] )  CELL PROPERTIES CELL_ORDINAL, VALUE, FORMATTED_VALUE, FORMAT_STRING, UPDATEABLE, TM1UPDATEABLE, ANNOTATED, CONSOLIDATED"</span><span class="p">,</span>
  <span class="s">"Meta"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">"Aliases"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"[d1].[h1]"</span><span class="p">:</span> <span class="s">"english"</span><span class="p">,</span>
      <span class="s">"[d3].[h1]"</span><span class="p">:</span> <span class="s">"english"</span><span class="p">,</span>
      <span class="s">"[d2].[h1]"</span><span class="p">:</span> <span class="s">"SKU"</span>
    <span class="p">},</span>
    <span class="s">"ExpandAboves"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"[d1].[h1]"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s">"[d1].[h2]"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s">"[d2].[h1]"</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">},</span>
    <span class="s">"ContextSets"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"[d2].[h1]"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"Expression"</span><span class="p">:</span> <span class="s">"{ HIERARCHIZE( { TM1SUBSETALL([d2]) } ) }"</span>
      <span class="p">},</span>
      <span class="s">"[d4].[h1]"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"SubsetName"</span><span class="p">:</span> <span class="s">"Default"</span>
      <span class="p">},</span>
      <span class="s">"[d5].[h1]"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"SubsetName"</span><span class="p">:</span> <span class="s">"All Deparments"</span><span class="p">,</span>
        <span class="s">"IsPublic"</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}})</span>
</code></pre></div>
<p>You can use the CreateFromCVS method with a Common View Specification to create an Exploration View with embedded additional state information.</p>

<p>A Common View Specification (CVS) is a JSON that can be used to embed additional state information when creating an Exploration View. A CVS is composed of two major parts; the MDX query and a sidecar for additional state information. Data driven mechanisms, such as TurboIntegrator are only concerned with the MDX query, however user interfaces will also consume the sidecar to ensure presentation consistency. By using a CVS, you can generate highly customizable Exploration Views. For example, using a CVS, you can define aliases and subsets as per the CVS schema input.</p>
<h3 id='syntax-3'>Syntax</h3>
<p>The following is the syntax for the CreateFromCVS method.</p>

<p><code>Reporting.Explorations.CreateFromCVS(“&lt;host system URL&gt;”, “&lt;server name&gt;”, “&lt;Common view specification&gt;”, &lt;boolean&gt;)</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Host system URL</td>
<td>The host system URL where you want to generate a new report.</td>
<td>String</td>
</tr>
<tr>
<td>Server name</td>
<td>The name of the server where you want to generate a new report.</td>
<td>String</td>
</tr>
<tr>
<td>Common View Specification</td>
<td>The common view specification that you want to use to generate the new report.</td>
<td>String</td>
</tr>
<tr>
<td>Boolean</td>
<td>Set to <code>true</code> if you want the report to be generated on a new sheet at the default location. Set to <code>false</code> if you want the report to be generated in the current sheet at the default location. The <code>false</code> setting will also delete existing reports on the sheet.</td>
<td>True/False boolean</td>
</tr>
</tbody></table>

<p>For more information about the Common View Specification schema, see <a href="#common-view-specification-schema">Commong View Specification schema</a>. </p>
<h2 id='createfrommdx-exploration'>CreateFromMDX (Exploration)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">CreateFromMDX</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">CreateFromMDX</span> <span class="s">"http://vottepps06.canlab.ibm.com:9510/"</span><span class="p">,</span> 
    <span class="s">"Planning Sample"</span><span class="p">,</span> <span class="s">"SELECT {[plan_chart_of_accounts].[plan_chart_of_accounts].
    [Revenue]} ON 0, {[plan_time].[plan_time].[2004]} ON 1 FROM [plan_BudgetPlan]"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>CreateFromMDX generates an Exploration View based on the host system URL, server name, and MDX string.</p>

<p>You may see an error if your MDX contains invalid members. Use the MDX Cleanup utility to automatically resolve invalid members. The MDX Cleanup utility resolves invalid members or removes them from the MDX if the members no longer exist.</p>

<p>The MDX Cleanup utility can be turned on by adding the following feature flag to your tm1features.json file.</p>

<p><code>{ &quot;r50_EnableMDXCleanupUtility&quot; : true }</code> </p>

<p>For more information about the tm1features.json file, see <a href="https://www.ibm.com/docs/en/planning-analytics/2.0.0?topic=started-manually-enabling-features-in-tm1featuresjson-file">Manually enabling features in the tm1features.json file</a></p>
<h3 id='syntax-4'>Syntax</h3>
<p>The following string is the syntax for the CreateFromMDX method.</p>

<p><code>Reporting.Explorations.CreateFromMDX “&lt;host system URL&gt;”, “&lt;server name&gt;”, “&lt;MDX&gt;”</code></p>
<h3 id='arguments-3'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Exploration View is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Exploration View is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>MDX</td>
<td>MDX statement which the Exploration View is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h2 id='getcolumnsuppression'>GetColumnSuppression</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">AreColumnsSuppressed</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span>
    <span class="n">GetColumnSuppression</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>GetColumnSuppression is used to return whether or not zero-suppression is applied to columns in the exploration.</p>
<h3 id='syntax-5'>Syntax</h3>
<p>The following string is the syntax for the GetColumnSuppression method.</p>

<p><code>Reporting.Explorations.GetAt().GetColumnSuppression</code></p>
<h2 id='getrowsuppression'>GetRowSuppression</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">AreRowsSuppressed</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span>
    <span class="n">GetRowSuppression</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>GetRowSuppression is used to return whether or not zero-suppression is applied to rows in the exploration.</p>
<h3 id='syntax-6'>Syntax</h3>
<p>The following string is the syntax for the GetRowSuppression method.</p>

<p><code>Reporting.Explorations.GetAt().GetRowSuppression</code></p>
<h2 id='getspecification'>GetSpecification</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">GetSpecification</span><span class="p">()</span>
    <span class="n">Msgbox</span>
<span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">GetSpecification</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>GetSpecification is used to return the MDX string that is used to build the current Exploration.</p>
<h3 id='syntax-7'>Syntax</h3>
<p>The following string is the syntax for the GetSpecification method.</p>

<p><code>Reporting.Explorations.GetAt().GetSpecification</code></p>
<h2 id='getvalue'>GetValue</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ToggleSetEditorPreview</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"SetEditorPreviewOn"</span><span class="p">)</span>
    <span class="k">If</span> <span class="s">"True"</span> <span class="o">=</span> <span class="n">x</span> <span class="k">Then</span>
        <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">SetValue</span> <span class="s">"SetEditorPreviewOn"</span><span class="p">,</span> <span class="s">"False"</span>
    <span class="k">Else</span>
        <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">SetValue</span> <span class="s">"SetEditorPreviewOn"</span><span class="p">,</span> <span class="s">"True"</span>
    <span class="k">End</span> <span class="k">If</span>  
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>GetValue is used to retrieve the value of a particular setting in a session.</p>
<h3 id='syntax-8'>Syntax</h3>
<p>The following string is the syntax for the GetValue method.</p>

<p><code>Reporting.Settings.GetValue(&quot;&lt;Setting&gt;&quot;)</code></p>
<h3 id='arguments-4'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Setting</td>
<td>The name of the setting whose value you want to retrieve.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='refresh-exploration'>Refresh (Exploration)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Refresh</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">Refresh</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Refresh is used to refresh the exploration.</p>
<h3 id='syntax-9'>Syntax</h3>
<p>The following string is the syntax for the Refresh method.</p>

<p><code>Reporting.Explorations.GetAt().Refresh</code></p>
<h2 id='swaprowsandcolumns'>SwapRowsAndColumns</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">SwapsRowsAndColumns</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">SwapsRowsAndColumns</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>SwapRowsAndColumns is used to swap the rows and columns in an exploration.</p>
<h3 id='syntax-10'>Syntax</h3>
<p>The following string is the syntax for the SwapRowsAndColumns method.</p>

<p><code>Reporting.Explorations.GetAt().SwapRowsAndColumns</code></p>
<h2 id='setrowsuppression'>SetRowSuppression</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">SetRowSuppressions</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">SetRowSuppression</span> 
    <span class="k">True</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>SetRowSuppression is used to enable and disable zero-suppression for rows in an exploration.</p>
<h3 id='syntax-11'>Syntax</h3>
<p>The following string is the syntax for the SetRowSuppression method.</p>

<p><code>Reporting.Explorations.GetAt().SetRowSuppression &lt;True/False value&gt;</code></p>
<h3 id='arguments-5'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Enables zero-suppression.</td>
<td>Boolean</td>
</tr>
<tr>
<td>False</td>
<td>Disables zero-suppression.</td>
<td>Boolean</td>
</tr>
</tbody></table>
<h2 id='setcolumnsuppression'>SetColumnSuppression</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">SetColumnSuppressions</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">SetColumnSuppression</span> 
    <span class="k">True</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>SetColumnSuppression is used to enable and disable zero-suppression for columns in an exploration.</p>
<h3 id='syntax-12'>Syntax</h3>
<p>The following string is the syntax for the SetColumnSuppression method.</p>

<p><code>Reporting.Explorations.GetAt().SetColumnSuppression &lt;True/False value&gt;</code></p>
<h3 id='arguments-6'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Enables zero-suppression.</td>
<td>Boolean</td>
</tr>
<tr>
<td>False</td>
<td>Disables zero-suppression.</td>
<td>Boolean</td>
</tr>
</tbody></table>
<h2 id='setspecification'>SetSpecification</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">SetSpecifications</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">SetSpecification</span> 
    <span class="s">"SELECT TM1SubsetToSet([plan_time], </span><span class="se">""</span><span class="s">current_year_and_qtrs</span><span class="se">""</span><span class="s">) DIMENSION 
    PROPERTIES MEMBER_UNIQUE_NAME, MEMBER_NAME, MEMBER_CAPTION, LEVEL_NUMBER, 
    CHILDREN_CARDINALITY, [plan_time].[Time] ON 0, TM1TOGGLEDRILLSTATE
    (TM1SubsetToSet([plan_chart_of_accounts], </span><span class="se">""</span><span class="s">Default</span><span class="se">""</span><span class="s">) , 
    {[plan_chart_of_accounts].[Revenue],[plan_chart_of_accounts].
    [Operating Expense]} , EXPAND_BELOW , RECURSIVE) DIMENSION PROPERTIES 
    MEMBER_UNIQUE_NAME, MEMBER_NAME, MEMBER_CAPTION, LEVEL_NUMBER, 
    CHILDREN_CARDINALITY, [plan_chart_of_accounts].[AccountName] ON 1 FROM 
    [plan_BudgetPlan] WHERE ([plan_version].[FY 2004 Budget] , 
    [plan_business_unit].[10000] , [plan_department].[1000] , 
    [plan_exchange_rates].[actual] , [plan_source].[goal]) DIMENSION PROPERTIES 
    MEMBER_UNIQUE_NAME, MEMBER_NAME, MEMBER_CAPTION, LEVEL_NUMBER, 
    CHILDREN_CARDINALITY , [plan_version].[VersionName] , [plan_business_unit].
    [BusinessUnit] , [plan_department].[Department] , [plan_source].[Source]"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>SetSpecification is used to define the subset and dimension properties of an existing exploration.</p>
<h3 id='syntax-13'>Syntax</h3>
<p>The following string is the syntax for the SetSpecification method.</p>

<p><code>Reporting.Explorations.GetAt().SetSpecification “&lt;MDX&gt;”</code></p>
<h3 id='arguments-7'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>MDX</td>
<td>MDX statement used to define the subset and dimension properties of the exploration.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='setvalue'>SetValue</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ToggleSetEditorPreview</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"SetEditorPreviewOn"</span><span class="p">)</span>
    <span class="k">If</span> <span class="s">"True"</span> <span class="o">=</span> <span class="n">x</span> <span class="k">Then</span>
        <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">SetValue</span> <span class="s">"SetEditorPreviewOn"</span><span class="p">,</span> <span class="s">"False"</span>
    <span class="k">Else</span>
        <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">SetValue</span> <span class="s">"SetEditorPreviewOn"</span><span class="p">,</span> <span class="s">"True"</span>
    <span class="k">End</span> <span class="k">If</span>  
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>SetValue is used to set a new value for a specific setting and save the changes to the settings file.</p>
<h3 id='syntax-14'>Syntax</h3>
<p>The following string is the syntax for the SetValue method.</p>

<p><code>Reporting.Settings.SetValue &quot;&lt;Setting&gt;&quot;, &quot;&lt;Value&gt;&quot;</code></p>
<h3 id='arguments-8'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Setting</td>
<td>The name of the setting whose value you want to set.</td>
<td>String</td>
</tr>
<tr>
<td>Value</td>
<td>The boolean value you want to set for the specified setting.</td>
<td>True/False boolean</td>
</tr>
</tbody></table>
<h2 id='unlink'>Unlink</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Unlink</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">Explorations</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">Unlink</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Unlink is used to convert an exploration to a static worksheet.</p>
<h3 id='syntax-15'>Syntax</h3>
<p>The following string is the syntax for the Unlink method.</p>

<p><code>Reporting.Explorations.GetAt().Unlink</code></p>
<h1 id='quick-report-api-functions'>Quick Report API functions</h1>
<p>Quick Report functions can be used to interact with Quick Report worksheets. </p>

<p>Quick Report functions can use the following PropertyAccessor objects:</p>

<table><thead>
<tr>
<th>PropertyAccessor</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Count</td>
<td>Counts the number of Quick Reports in the active book.</td>
</tr>
<tr>
<td>GetReports()</td>
<td>Gets the collection of Quick Report objects from the active book.</td>
</tr>
</tbody></table>

<p>The Quick Report functions that are exposed through the IBM® Cognos® automation objects are:</p>
<h2 id='clear-quick-report'>Clear (Quick Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Clear</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">Clear</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Clear is used to clear data from the Quick Report.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the Clear method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).Clear</code></p>
<h2 id='columnhierarchies'>ColumnHierarchies</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Sub</span> <span class="nf">ColumnHierarchies</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">columns</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">For</span> <span class="k">Each</span> <span class="n">Column</span> <span class="ow">In</span> <span class="n">cafe</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"0"</span><span class="p">).</span><span class="n">ColumnDimensions</span>
        <span class="k">If</span> <span class="n">columns</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">&amp;</span> <span class="s">", "</span> <span class="o">&amp;</span> <span class="n">vbNewLine</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">&amp;</span> <span class="n">Column</span>
    <span class="n">MsgBox</span> <span class="s">"Columns:"</span> <span class="n">columns</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>ColumnHierarchies is used to return the hierarchies that exist in the columns of a Quick Report report.</p>
<h3 id='syntax-2'>Syntax</h3>
<p>The following string is the syntax for the ColumnHierarchies method.</p>

<p><code>cafe.QuickReports.Get(&quot;&lt;Quick Report ID&quot;).ColumnDimensions</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Quick Report ID</td>
<td>The ID of the Quick Report that the column hierarchies are being returned from</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='commit'>Commit</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Commit</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">Commit</span> <span class="k">True</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Commit is used to commit the Quick Report report.</p>
<h3 id='syntax-3'>Syntax</h3>
<p>The following string is the syntax for the Commit method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).Commit &lt;True&gt;</code></p>
<h2 id='create-quick-report'>Create (Quick Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Create</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">Create</span> <span class="s">"http://computername/"</span><span class="p">,</span> <span class="s">"Planning Sample"</span><span class="p">,</span> 
    <span class="s">"plan_BudgetPlan"</span><span class="p">,</span> <span class="s">"Goal Input"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Create generates a Quick Report based on the host system URL, server name, cube name, and view name.</p>
<h3 id='syntax-4'>Syntax</h3>
<p>The following string is the syntax for the Create method.</p>

<p><code>Reporting.QuickReports.Create &quot;&lt;host system URL&gt;&quot;, &quot;&lt;server name&gt;&quot;, &quot;&lt;cube name&gt;&quot;, &quot;&lt;view name&gt;&quot;</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Quick Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Quick Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>cube name</td>
<td>Name of the cube which the Quick Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>view name</td>
<td>Name of the view which the Quick Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h2 id='createfromcvs-quick-report'>CreateFromCVS (Quick Report)</h2>
<blockquote>
<p>Example of the syntax for updating the common view specification of a report:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">CreateFromCVS</span><span class="p">(</span><span class="s">"http://server-example.ibm.com"</span><span class="p">,</span> <span class="s">"Planning Sample"</span><span class="p">,</span> 
<span class="p">{</span>
  <span class="s">"MDX"</span><span class="p">:</span> <span class="s">"SELECT {([d1].[h1].[line 2],[d3].[h1].[2004]),([d1].[h1].[line 2],[d3].[h1].[Q1-2004]),([d1].[h1].[line 2],[d3].[h1].[Jan-2004])}  DIMENSION PROPERTIES MEMBER_UNIQUE_NAME, LEVEL_NUMBER, CHILDREN_CARDINALITY ON 0  FROM [my_Cube] WHERE ( [d2].[h1].[toys], [d4].[h1].[USD], [d5].[h1].[Sales] )  CELL PROPERTIES CELL_ORDINAL, VALUE, FORMATTED_VALUE, FORMAT_STRING, UPDATEABLE, TM1UPDATEABLE, ANNOTATED, CONSOLIDATED"</span><span class="p">,</span>
  <span class="s">"Meta"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">"Aliases"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"[d1].[h1]"</span><span class="p">:</span> <span class="s">"english"</span><span class="p">,</span>
      <span class="s">"[d3].[h1]"</span><span class="p">:</span> <span class="s">"english"</span><span class="p">,</span>
      <span class="s">"[d2].[h1]"</span><span class="p">:</span> <span class="s">"SKU"</span>
    <span class="p">},</span>
    <span class="s">"ExpandAboves"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"[d1].[h1]"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s">"[d1].[h2]"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s">"[d2].[h1]"</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">},</span>
    <span class="s">"ContextSets"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">"[d2].[h1]"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"Expression"</span><span class="p">:</span> <span class="s">"{ HIERARCHIZE( { TM1SUBSETALL([d2]) } ) }"</span>
      <span class="p">},</span>
      <span class="s">"[d4].[h1]"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"SubsetName"</span><span class="p">:</span> <span class="s">"Default"</span>
      <span class="p">},</span>
      <span class="s">"[d5].[h1]"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"SubsetName"</span><span class="p">:</span> <span class="s">"All Deparments"</span><span class="p">,</span>
        <span class="s">"IsPublic"</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}})</span>
</code></pre></div>
<p>You can use the CreateFromCVS method with a Common View Specification to create a Quick Report with embedded additional state information.</p>

<p>A Common View Specification (CVS) is a JSON that can be used to embed additional state information when creating a Quick Report. A CVS is composed of two major parts; the MDX query and a sidecar for additional state information. Data driven mechanisms, such as TurboIntegrator are only concerned with the MDX query, however user interfaces will also consume the sidecar to ensure presentation consistency. By using a CVS, you can generate highly customizable Quick Reports. For example, using a CVS, you can define aliases and subsets as per the CVS schema input.</p>
<h3 id='syntax-5'>Syntax</h3>
<p>The following is the syntax for the CreateFromCVS method.</p>

<p><code>Reporting.QuickReports.CreateFromCVS(“&lt;host system URL&gt;”, “&lt;server name&gt;”, “&lt;Common view specification&gt;”, &lt;boolean&gt;)</code></p>
<h3 id='arguments-3'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Host system URL</td>
<td>The host system URL where you want to generate a new report.</td>
<td>String</td>
</tr>
<tr>
<td>Server name</td>
<td>The name of the server where you want to generate a new report.</td>
<td>String</td>
</tr>
<tr>
<td>Common View Specification</td>
<td>The common view specification that you want to use to generate the new report.</td>
<td>String</td>
</tr>
<tr>
<td>Boolean</td>
<td>Set to true if you want the report to be generated on a new sheet, in cell A1. Set to false if you want the report to be generated in the current sheet, starting on the current cell.</td>
<td>True/False boolean</td>
</tr>
</tbody></table>

<p>For more information about the Common View Specification schema, see <a href="#common-view-specification-schema">Commong View Specification schema</a>.</p>
<h2 id='createfrommdx-quick-report'>CreateFromMDX (Quick Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">CreateFromMDX</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">CreateFromMDX</span> <span class="s">"http://vottepps06.canlab.ibm.com:9510/"</span><span class="p">,</span>
    <span class="s">"Planning Sample"</span><span class="p">,</span> <span class="s">"SELECT {[plan_chart_of_accounts].[plan_chart_of_accounts].
    [Revenue]} ON 0, {[plan_time].[plan_time].[2004]} ON 1 FROM [plan_BudgetPlan]"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>CreateFromMDX generates a Quick Report based on the host system URL, server name, and MDX string.</p>
<h3 id='syntax-6'>Syntax</h3>
<p>The following string is the syntax for the CreateFromMDX method.</p>

<p><code>Reporting.QuickReports.CreateFromMDX “&lt;host system URL&gt;”, “&lt;server name&gt;”, “&lt;MDX&gt;”</code></p>
<h3 id='arguments-4'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Quick Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Quick Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>MDX</td>
<td>MDX statement which the Quick Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h2 id='cube'>Cube</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Cube</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">Cube</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<blockquote>
<p>If the Quick Report is located in the plan_BudgetPlan cube, in the Planning Sample server, the Cube function would return:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="err">“</span><span class="p">{</span><span class="err">“</span><span class="n">server</span><span class="err">”</span><span class="p">:</span><span class="n">Planning</span> <span class="n">Sample</span><span class="p">,</span> <span class="err">“</span><span class="n">cube</span><span class="err">”</span><span class="p">:</span><span class="n">plan_BudgetPlan</span><span class="p">}</span><span class="err">”</span>
</code></pre></div>
<p>Cube returns the search path of the Quick Report. </p>
<h3 id='syntax-7'>Syntax</h3>
<p>The following string is the syntax for the Cube method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).Cube</code></p>
<h2 id='datasource'>DataSource</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">DataSource</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">DataSource</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>DataSource is used to return the Quick Report host URL.</p>
<h3 id='syntax-8'>Syntax</h3>
<p>The following string is the syntax for the DataSource method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).DataSource</code></p>
<h2 id='enableindents'>EnableIndents</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">EnableIndents</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">EnableIndents</span> <span class="k">True</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>EnableIndents is used to enable level based indents in your Quick Report reports.</p>
<h3 id='syntax-9'>Syntax</h3>
<p>The following string is the syntax for the EnableIndents method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).EnableIndents &lt;True/False value&gt;</code></p>
<h3 id='arguments-5'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Enables indents in Quick Reports.</td>
<td>Boolean</td>
</tr>
<tr>
<td>False</td>
<td>Disables indents in Quick Reports.</td>
<td>Boolean</td>
</tr>
</tbody></table>
<h2 id='executequery'>ExecuteQuery</h2>
<blockquote>
<p>The following syntax is an example of the ExecuteQuery method stored in a VBA module:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">GetRowsAxis</span><span class="p">(</span><span class="n">query</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">Collection</span>
    <span class="k">Set</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">(</span><span class="s">"http://pa.exampletm1.ibmcloud.com"</span><span class="p">,</span> <span class="s">"SData"</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">MDX</span> <span class="n">query</span><span class="o">&gt;</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Collection</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetAxes</span><span class="p">().</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">GetProperties</span><span class="p">().</span><span class="n">Item</span><span class="p">(</span><span class="s">"tuples"</span><span class="p">).</span><span class="n">GetMembers</span><span class="p">().</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">result</span><span class="p">.</span><span class="n">Add</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetAxes</span><span class="p">().</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">GetProperties</span><span class="p">().</span><span class="n">Item</span><span class="p">(</span><span class="s">"tuples"</span><span class="p">).</span><span class="n">GetMembers</span><span class="p">().</span><span class="n">Item</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">GetMembers</span><span class="p">().</span><span class="n">Item</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">GetValue</span><span class="p">())</span>
    <span class="k">Next</span> <span class="n">i</span>
    <span class="k">Set</span> <span class="n">GetRowsAxis</span> <span class="o">=</span> <span class="n">result</span>
<span class="k">End</span> <span class="k">Property</span>
</code></pre></div>
<blockquote>
<p>The following syntax is an example of the ExecuteQuery method being called in a worksheet:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Worksheet_Change</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">c</span> <span class="ow">As</span> <span class="n">Collection</span>
    <span class="k">Set</span> <span class="n">c</span> <span class="o">=</span> <span class="n">RefreshAPIExample</span><span class="p">.</span><span class="n">GetRowsAxis</span><span class="p">(</span><span class="n">Cells</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">).</span><span class="n">Value2</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<blockquote>
<p>ExecuteQuery is triggered from a worksheet change event on cell D20. If an MDX query string exists in cell D20, and is modified, the selected MDX will be executed through the ExecuteQuery call and will return a CellSet object. This CellSet object can then be traversed in a similar way to a JSON object.</p>
</blockquote>

<p>ExecuteQuery is a method used to execute selected MDX statements in your Quick Report reports.</p>
<h3 id='syntax-10'>Syntax</h3>
<p>The following string is the syntax for the ExecuteQuery method.</p>

<p><code>Reporting.ExecuteQuery(&quot;&lt;data source URL&gt;&quot;, &quot;&lt;server name&gt;&quot;, &lt;MDX query&gt;)</code></p>
<h3 id='arguments-6'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>data source URL</td>
<td>The data source URL used in the Quick Report.</td>
<td>String</td>
</tr>
<tr>
<td>server name</td>
<td>The server name used in the Quick Report.</td>
<td>String</td>
</tr>
<tr>
<td>MDX query</td>
<td>The MDX query string to be executed by the method.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='gettuple'>GetTuple</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Sub</span> <span class="nf">PrintTuple</span><span class="p">()</span>
    <span class="k">Set</span> <span class="n">tupleObject</span> <span class="o">=</span> <span class="n">cafe</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"0"</span><span class="p">).</span><span class="n">GetTuple</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="nv">tuple</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">For</span> <span class="n">tupleIdx</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="n">tupleObject</span><span class="p">.</span><span class="n">Count</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">If</span> <span class="n">tuple</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
            <span class="n">tuple</span> <span class="o">=</span> <span class="n">tuple</span> <span class="o">&amp;</span> <span class="s">", "</span> <span class="o">&amp;</span> <span class="n">vbNewLine</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">tuple</span> <span class="o">=</span> <span class="n">tuple</span> <span class="o">&amp;</span> <span class="n">tupleObject</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="n">tupleIdx</span><span class="p">)</span>
    <span class="k">Next</span>
    <span class="n">MsgBox</span> <span class="s">"Tuple: "</span> <span class="o">&amp;</span> <span class="n">vbNewLine</span> <span class="o">&amp;</span> <span class="n">tuple</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>GetTuple is used to return the tuple of a Quick Report at a given range. This function will return the tuple at the ActiveCell if no range is specified.</p>
<h3 id='syntax-11'>Syntax</h3>
<p>The following string is the syntax for the GetTuple method.</p>

<p><code>cafe.QuickReports.Get(&quot;&lt;Quick Report ID&gt;&quot;).GetTuple(ActiveCell)</code></p>
<h3 id='arguments-7'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Quick Report ID</td>
<td>The ID of the Quick Report that the tuple is being returned from.</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='getspecification'>GetSpecification</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">GetSpecification</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">GetSpecification</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>GetSpecification is used to return the MDX string that is used to build the current Quick Report.</p>
<h3 id='syntax-12'>Syntax</h3>
<p>The following string is the syntax for the GetSpecification method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).GetSpecification</code></p>
<h2 id='getreport'>GetReport</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">GetReport</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">Get</span> <span class="p">(</span><span class="s">"5"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>GetReport is used to return a specific Quick Report based on the Quick Report ID.</p>
<h3 id='syntax-13'>Syntax</h3>
<p>The following string is the syntax for the GetReport method.</p>

<p><code>Reporting.QuickReports.Get (&quot;&lt;report ID&gt;&quot;)</code></p>
<h3 id='arguments-8'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>report ID</td>
<td>ID of the Quick Report which the function is to return.</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='id'>ID</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ID</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">ID</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>ID is used to return the Quick Report ID.</p>
<h3 id='syntax-14'>Syntax</h3>
<p>The following string is the syntax for the ID method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).ID</code></p>
<h2 id='name'>Name</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Name</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">Name</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Name is used to return the cube name and view name which the Quick Report is created from.</p>
<h3 id='syntax-15'>Syntax</h3>
<p>The following string is the syntax for the Name method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).Name</code></p>
<h2 id='rebuild'>Rebuild</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Rebuild</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">Rebuild</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Rebuild is used to rebuild a Quick Report.</p>
<h3 id='syntax-16'>Syntax</h3>
<p>The following string is the syntax for the Rebuild method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).Rebuild</code></p>
<h2 id='rebuildspecification'>RebuildSpecification</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">RebuildSpecification</span><span class="p">()</span>
    <span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">RebuildSpecification</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>RebuildSpecification is used to return the MDX string that is used when rebuilding the Quick Report.</p>
<h3 id='syntax-17'>Syntax</h3>
<p>The following string is the syntax for the RebuildSpecification method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).RebuildSpecification</code></p>
<h2 id='refresh-quick-report'>Refresh (Quick Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Refresh</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">Refresh</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Refresh is used to refresh a Quick Report.</p>
<h3 id='syntax-18'>Syntax</h3>
<p>The following string is the syntax for the Refresh method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).Refresh</code></p>
<h2 id='replace'>Replace</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Replace</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">Replace</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">).</span><span class="err">4,</span> 
    <span class="err">"</span><span class="n">SELECT</span> <span class="p">{</span><span class="err">[</span><span class="n">plan_chart_of_accounts</span><span class="err">]</span><span class="p">.</span><span class="err">[</span><span class="n">plan_chart_of_accounts</span><span class="err">]</span><span class="p">.</span><span class="err">[</span><span class="n">Revenue</span><span class="err">]</span><span class="p">}</span> <span class="n">ON</span> <span class="mi">0</span><span class="p">,</span> 
    <span class="p">{</span><span class="err">[</span><span class="n">plan_time</span><span class="err">]</span><span class="p">.</span><span class="err">[</span><span class="n">plan_time</span><span class="err">]</span><span class="p">.</span><span class="err">[2004]}</span> <span class="n">ON</span> <span class="mi">1</span> <span class="n">FROM</span> <span class="err">[</span><span class="n">plan_BudgetPlan</span><span class="err">]</span><span class="s">"
End Sub
</span></code></pre></div>
<p>Replace is used to replace the MDX statement in the Quick Report with another MDX statement.</p>
<h3 id='syntax-19'>Syntax</h3>
<p>The following string is the syntax for the Replace method.</p>

<p><code>Reporting.QuickReports.Replace Reporting.GetCurrentReport(ActiveCell).&lt;Quick Report ID&gt;, &lt;MDX statement&gt;</code></p>
<h3 id='arguments-9'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Quick Report ID</td>
<td>The ID of the Quick Report that will have its MDX statement replaced.</td>
<td>Integer</td>
</tr>
<tr>
<td>MDX statement</td>
<td>The MDX statement that will be replacing the current MDX statement in the Quick Report.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='replacewithformats'>ReplaceWithFormats</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ReplaceWithFormats</span><span class="p">()</span>
   <span class="n">Reporting</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">ReplaceWithFormats</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">).</span><span class="err">4,</span>
   <span class="err">"</span><span class="n">SELECT</span> <span class="p">{</span><span class="err">[</span><span class="n">plan_chart_of_accounts</span><span class="err">]</span><span class="p">.</span><span class="err">[</span><span class="n">plan_chart_of_accounts</span><span class="err">]</span><span class="p">.</span><span class="err">[</span><span class="n">Revenue</span><span class="err">]</span><span class="p">}</span> <span class="n">ON</span> <span class="mi">0</span><span class="p">,</span>
   <span class="p">{</span><span class="err">[</span><span class="n">plan_time</span><span class="err">]</span><span class="p">.</span><span class="err">[</span><span class="n">plan_time</span><span class="err">]</span><span class="p">.</span><span class="err">[2004]}</span> <span class="n">ON</span> <span class="mi">1</span> <span class="n">FROM</span> <span class="err">[</span><span class="n">plan_BudgetPlan</span><span class="err">]</span><span class="s">", True
End Sub
</span></code></pre></div>
<p>ReplaceWithFormats is used to replace the MDX statement in the Quick Report with another MDX statement. ReplaceWithFormats also has the option to preserve or destroy the existing sheet formatting in the Quick Report.</p>
<h3 id='syntax-20'>Syntax</h3>
<p>The following string is the syntax for the ReplaceWithFormats method.</p>

<p><code>Reporting.QuickReports.ReplaceWithFormats Reporting.GetCurrentReport(ActiveCell).&lt;Quick Report ID&gt;, &lt;MDX statement&gt;, &lt;ReFormat&gt;</code></p>
<h3 id='arguments-10'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Quick Report ID</td>
<td>The ID of the Quick Report that will have its MDX statement replaced.</td>
<td>Integer</td>
</tr>
<tr>
<td>MDX statement</td>
<td>The MDX statement that will be replacing the current MDX statement in the Quick Report.</td>
<td>String</td>
</tr>
<tr>
<td>ReFormat</td>
<td>Defines whether or not to preserve or destroy the sheet formatting in the existing Quick Report. <code>True</code> preserves the sheet formatting. <code>False</code> destroys the sheet formatting.</td>
<td>Boolean</td>
</tr>
</tbody></table>
<h2 id='rowhierarchies'>RowHierarchies</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Sub</span> <span class="nf">RowHierarchies</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">slicers</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">For</span> <span class="k">Each</span> <span class="n">Slicer</span> <span class="ow">In</span> <span class="n">cafe</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"0"</span><span class="p">).</span><span class="n">SlicerDimensions</span>
        <span class="k">If</span> <span class="n">slicers</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
            <span class="n">slicers</span> <span class="o">=</span> <span class="n">slicers</span> <span class="o">&amp;</span> <span class="s">", "</span> <span class="o">&amp;</span> <span class="n">vbNewLine</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">slicers</span> <span class="o">=</span> <span class="n">slicers</span> <span class="o">&amp;</span> <span class="n">Slicer</span>
    <span class="k">Next</span>
    <span class="n">MsgBox</span> <span class="s">"Rows:"</span> <span class="n">rows</span> 
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>RowHierarchies is used to return the hierarchies that exist in the rows of a Quick Report.</p>
<h3 id='syntax-21'>Syntax</h3>
<p>The following string is the syntax for the RowHierarchies method.</p>

<p><code>cafe.QuickReports.Get(&quot;&lt;Quick Report ID&quot;).RowDimensions</code></p>
<h3 id='arguments-11'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Quick Report ID</td>
<td>The ID of the Quick Report that the row hierarchies are being returned from.</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='select'>Select</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">SelectReport</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">Select</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Select is used to select and highlight the current active Quick Report.</p>
<h3 id='syntax-22'>Syntax</h3>
<p>The following string is the syntax for the Select method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).Select</code></p>
<h2 id='setslicer'>SetSlicer</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">SetSlicer</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ActiveCell</span><span class="o">&gt;</span><span class="p">).</span><span class="n">SetSlicer</span> <span class="s">"[plan_business_unit].
    [plan_business_unit]"</span><span class="p">,</span> <span class="s">"10100"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>SetSlicer is used to set the values for a slicer dimension in the Quick Report.</p>
<h3 id='syntax-23'>Syntax</h3>
<p>The following string is the syntax for the SetSlicer method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).SetSlicer “&lt;dimensions&gt;, &lt;name&gt;”</code></p>
<h3 id='arguments-12'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>dimensions</td>
<td>The dimensions to set the slicer to.</td>
<td>String</td>
</tr>
<tr>
<td>name</td>
<td>The name to set the slicer to.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='slicerhierarchies'>SlicerHierarchies</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Sub</span> <span class="nf">RowHierarchies</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">slicers</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">For</span> <span class="k">Each</span> <span class="n">Slicer</span> <span class="ow">In</span> <span class="n">cafe</span><span class="p">.</span><span class="n">QuickReports</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"0"</span><span class="p">).</span><span class="n">SlicerDimensions</span>
        <span class="k">If</span> <span class="n">slicers</span> <span class="o">&lt;&gt;</span> <span class="s">""</span> <span class="k">Then</span>
            <span class="n">slicers</span> <span class="o">=</span> <span class="n">slicers</span> <span class="o">&amp;</span> <span class="s">", "</span> <span class="o">&amp;</span> <span class="n">vbNewLine</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">slicers</span> <span class="o">=</span> <span class="n">slicers</span> <span class="o">&amp;</span> <span class="n">Slicer</span>
    <span class="k">Next</span>
    <span class="n">MsgBox</span> <span class="s">"Slicers:"</span> <span class="n">slicers</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>SlicerHierarchies is used to return the hierarchies that exist in the slicers of a Quick Report.</p>
<h3 id='syntax-24'>Syntax</h3>
<p>The following string is the syntax for the SlicerHierarchies method.</p>

<p><code>cafe.QuickReports.Get(&quot;&lt;Quick Report ID&quot;).SlicerDimensions</code></p>
<h3 id='arguments-13'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Quick Report ID</td>
<td>The ID of the Quick Report that the slicer hierarchies are being returned from.</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='useserverformats'>UseServerFormats</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ToggleServerFormats</span><span class="p">(</span><span class="n">r</span> <span class="ow">As</span> <span class="n">Range</span><span class="p">)</span>
   <span class="n">r</span><span class="p">.</span><span class="n">Worksheet</span><span class="p">.</span><span class="n">Activate</span>
   <span class="k">Set</span> <span class="n">fView</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetCurrentReport</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
   <span class="k">If</span> <span class="k">Not</span> <span class="p">(</span><span class="n">fView</span> <span class="ow">Is</span> <span class="k">Nothing</span><span class="p">)</span> <span class="k">Then</span>
     <span class="n">fView</span><span class="p">.</span><span class="n">UseServerFormats</span> <span class="o">=</span> <span class="k">Not</span> <span class="n">fView</span><span class="p">.</span><span class="n">UseServerFormats</span>
     <span class="n">fView</span><span class="p">.</span><span class="n">Refresh</span>
   <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>UseServerFormats clears any user applied formatting and applies server based formatting after a Quick Report is refreshed.</p>
<h3 id='syntax-25'>Syntax</h3>
<p>The following string is the syntax for the UseServerFormats method.</p>

<p><code>Reporting.GetCurrentReport(&lt;ActiveCell&gt;).UseServerFormats = &lt;True/False&gt;</code></p>
<h1 id='dynamic-report-api-functions'>Dynamic Report API functions</h1>
<p>Dynamic Report functions can be used to interact with Dynamic Report worksheets. </p>

<p>Dynamic Report functions can use the following PropertyAccessor objects:</p>

<table><thead>
<tr>
<th>PropertyAccessor</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>GetReports()</td>
<td>Gets the collection of Dynamic Report objects from the active book.</td>
</tr>
<tr>
<td>GetAt(sheet)</td>
<td>Gets the collection of Dynamic Report objects from the specified sheet name in the active book.</td>
</tr>
<tr>
<td>Get(ignored, sheet, id)</td>
<td>Gets the Dynamic Report object from the specified sheet name, with the given ID, in the active book.</td>
</tr>
</tbody></table>

<p>The Dynamic Report functions that are exposed through the IBM® Cognos® automation objects are:</p>
<h2 id='create-dynamic-report'>Create (Dynamic Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Create</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">create</span> <span class="s">"http://computername"</span><span class="p">,</span> <span class="s">"Planning Sample"</span><span class="p">,</span> 
    <span class="s">"plan_BudgetPlan"</span><span class="p">,</span> <span class="s">"Goal Input"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Create generates an Dynamic Report based on the host system URL, server name, cube name, and view name.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the Create method.</p>

<p><code>Reporting.DynamicReports.create &quot;&lt;host system URL&gt;&quot;, &quot;&lt;server name&gt;&quot;, &quot;&lt;cube name&gt;&quot;, &quot;&lt;view name&gt;&quot;</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Dynamic Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Dynamic Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>cube name</td>
<td>Name of the cube which the Dynamic Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>view name</td>
<td>Name of the view which the Dynamic Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h2 id='createfrommdx-dynamic-report'>CreatefromMDX (Dynamic Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">CreateFromMDX</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">CreateFromMDX</span> <span class="s">"http://vottepps06.canlab.ibm.com:9510/"</span><span class="p">,</span>
   <span class="s">"Planning Sample"</span><span class="p">,</span> <span class="s">"SELECT {[plan_chart_of_accounts].[plan_chart_of_accounts].
   [Revenue]} ON 0, {[plan_time].[plan_time].[2004]} ON 1 FROM [plan_BudgetPlan]"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>CreateFromMDX generates a Dynamic Report based on a host system URL, server name, and MDX string.</p>
<h3 id='syntax-2'>Syntax</h3>
<p>The following string is the syntax for the CreatefromMDX method.</p>

<p><code>Reporting.DynamicReports.CreatefromMDX &quot;&lt;host system URL&gt;&quot;, &quot;&lt;server name&gt;&quot;, &quot;&lt;MDX statement&gt;&quot;</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Dynamic Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Dynamic Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>MDX statement</td>
<td>MDX statement which the Dynamic Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h2 id='getmdx'>GetMDX</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">MsgBox</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">name</span><span class="p">).</span><span class="n">Item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">GetMDX</span>
</code></pre></div>
<p>This API call is used to return the MDX for theDynamic Report row.</p>
<h3 id='syntax-3'>Syntax</h3>
<p>The following string is the syntax for the GetMDX method.</p>

<p><code>Reporting.DynamicReports.GetAt(Application.ActiveSheet.name).Item(0).GetMDX</code></p>
<h2 id='formatareavisible'>FormatAreaVisible</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Create</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">name</span><span class="p">).</span><span class="n">Item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">FormatAreaVisible</span> <span class="p">(</span><span class="n">true</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>This API call is used to show and hide the formatting area in a Dynamic Report.</p>
<h3 id='syntax-4'>Syntax</h3>
<p>The following string is the syntax for the FormatAreaVisible method.</p>

<p><code>Reporting.DynamicReports.GetAt(Application.ActiveSheet.name).Item(0).FormatAreaVisible (&lt;true/false&gt;)</code></p>
<h3 id='arguments-3'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>true/false</td>
<td>true: Shows the formatting area in the Dynamic Report. false: Hides the formatting area in the Dynamic Report.</td>
<td>Boolean</td>
</tr>
</tbody></table>
<h2 id='refresh-dynamic-report'>Refresh (Dynamic Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">Worksheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">Item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Refresh</span>
</code></pre></div>
<p>This API call is used to refresh a Dynamic Report.</p>
<h3 id='syntax-5'>Syntax</h3>
<p>The following string is the syntax for the Refresh method.</p>

<p><code>Reporting.DynamicReports.GetAt().Item(&lt;Dynamic Report ID&gt;).Refresh</code></p>

<aside class="notice">
The `Dynamic Report ID` is not the actual ID, but the ordinal position. If you have multiple Dynamic Reports on a sheet, you can use `GetAt(#)` to define the ordinal position of the Dynamic Report. <br> <b>Examples:</b> <br> Reporting.DynamicReports.GetAt().Item(0).Rebuild  refers to the first Dynamic Report. <br>
Reporting.DynamicReports.GetAt().Item(1).Rebuild refers to the second Dynamic Report.
</aside>
<h3 id='arguments-4'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Dynamic Report ID</td>
<td>The ID of the Dynamic Report that is to be refreshed.</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='rebuild-dynamic-report'>Rebuild (Dynamic Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="n">Reporting</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">GetAt</span><span class="p">(</span><span class="n">ActiveCell</span><span class="p">.</span><span class="n">Worksheet</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">Item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Rebuild</span>
</code></pre></div>
<p>This API call is used to rebuild a Dynamic Report.</p>
<h3 id='syntax-6'>Syntax</h3>
<p>The following string is the syntax for the Rebuild method.</p>

<p><code>Reporting.DynamicReports.GetAt().Item(&lt;Dynamic Report ID&gt;).Rebuild</code></p>

<aside class="notice">
The `Dynamic Report ID` is not the actual ID, but the ordinal position. If you have multiple Dynamic Reports on a sheet, you can use `GetAt(#)` to define the ordinal position of the Dynamic Report. <br> <b>Examples:</b> <br> Reporting.DynamicReports.GetAt().Item(0).Rebuild  refers to the first Dynamic Report. <br>
Reporting.DynamicReports.GetAt().Item(1).Rebuild refers to the second Dynamic Report.
</aside>
<h3 id='arguments-5'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>Dynamic Report ID</td>
<td>The ID of the Dynamic Report that is to be rebuilt.</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='rebuildactivesheet'>RebuildActiveSheet</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">RebuildMyDynamicReportSheet</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">test</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Set</span> <span class="n">test</span> <span class="o">=</span> <span class="n">Reporting</span>
    <span class="c1">'New call to rebuild active sheet.</span>
    <span class="n">test</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">RebuildActiveSheet</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>This API call is used to rebuild the active sheet.</p>
<h3 id='syntax-7'>Syntax</h3>
<p>The following string is the syntax for the RebuildActiveSheet method.
<code>Reporting.DynamicReports.RebuildActiveSheet</code></p>
<h2 id='rebuildactivebook'>RebuildActiveBook</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">RebuildMyDynamicReportWorkbook</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">test</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Set</span> <span class="n">test</span> <span class="o">=</span> <span class="n">Reporting</span>
    <span class="c1">'New call to rebuild active workbook.</span>
    <span class="n">test</span><span class="p">.</span><span class="n">DynamicReports</span><span class="p">.</span><span class="n">RebuildActiveWorkbook</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>This API call is used to rebuild the Dynamic Reports in the active workbook, even if the Dynamic Reports are on different sheets.</p>
<h3 id='syntax-8'>Syntax</h3>
<p>The following string is the syntax for the Rebuildbook method.
<code>Reporting.DynamicReports.RebuildActiveWorkbook</code></p>
<h1 id='custom-report-api-function'>Custom Report API function</h1>
<p>Custom Report functions can be used to interact with Custom Report worksheets. The Custom Report functions that are exposed through the IBM® Cognos® automation objects are:</p>
<h2 id='create-custom-report'>Create (Custom Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Create</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">CustomReports</span><span class="p">.</span><span class="n">create</span> <span class="s">"http://computername"</span><span class="p">,</span> <span class="s">"Planning Sample"</span><span class="p">,</span> <span class="s">"plan_BudgetPlan"</span><span class="p">,</span> <span class="s">"Goal Input"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>Create generates an Custom Report based on the host system URL, server name, cube name, and view name.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the Create method.</p>

<p><code>Reporting.CustomReports.create &quot;&lt;host system URL&gt;&quot;, &quot;&lt;server name&gt;&quot;, &quot;&lt;cube name&gt;&quot;, &quot;&lt;view name&gt;&quot;</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Custom Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Custom Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>cube name</td>
<td>Name of the cube which the Custom Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>view name</td>
<td>Name of the view which the Custom Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h2 id='createfrommdx-custom-report'>CreatefromMDX (Custom Report)</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">CreateFromMDX</span><span class="p">()</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">CustomReports</span><span class="p">.</span><span class="n">createfromMDX</span> <span class="s">"http://vottepps06.canlab.ibm.com:9510/"</span><span class="p">,</span>
   <span class="s">"Planning Sample"</span><span class="p">,</span> <span class="s">"SELECT {[plan_chart_of_accounts].[plan_chart_of_accounts].
   [Revenue]} ON 0, {[plan_time].[plan_time].[2004]} ON 1 FROM [plan_BudgetPlan]"</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>CreateFromMDX generates a Custom Report based on a host system URL, server name, and MDX string.</p>
<h3 id='syntax-2'>Syntax</h3>
<p>The following string is the syntax for the CreatefromMDX method.</p>

<p><code>Reporting.CustomReports.createfromMDX &quot;&lt;host system URL&gt;&quot;, &quot;&lt;server name&gt;&quot;, &quot;&lt;MDX statement&gt;&quot;</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>host system URL</td>
<td>URL of the host system which the Custom Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Custom Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
<tr>
<td>MDX statement</td>
<td>MDX statement which the Custom Report is to be created from.</td>
<td>Alphanumeric string</td>
</tr>
</tbody></table>
<h1 id='turbointegrator-functions'>TurboIntegrator functions</h1><h2 id='before-you-begin'>Before you begin</h2>
<p>You must use Microsoft Excel 2007 or a later version to have the option to create ActiveX command button controls.</p>
<h2 id='procedure'>Procedure</h2>
<ol>
<li>In Microsoft Excel, customize the ribbon to show the <strong>Developer</strong> tab.</li>
<li>Add an ActiveX command button control to the worksheet.
For more information about creating a command button, see the Microsoft web site.</li>
<li>Right-click the command button and click <strong>View Code</strong>.</li>
<li>Add <code>ExecuteFunction</code> to the command button.</li>
</ol>
<h2 id='results'>Results</h2>
<p>To use the command button, you must be logged into the TM1 system specified in the ExecuteFunction call. You can use an automation function to log into the TM1 system. To learn more about ExecuteFunction, see ExecuteFunction.</p>

<aside class="notice">
The `installation_location\Automation\COAutomationExample.xls` sample file contains code for `ExecuteFunction`. The `ExecuteFunction` code demonstrates how to use the IBM® Cognos® automation API to execute TurboIntegrator scripts. For information about TurboIntegrator functions, see the TM1 TurboIntegrator guide.
</aside>
<h2 id='executefunction'>ExecuteFunction</h2>
<blockquote>
<p>The following is an example of an ExecuteFunction method, which creates a subset called &quot;TITest&quot; in the &quot;plan_version&quot; dimension:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ExecuteFunction</span> <span class="s">"http://host_address:host_port"</span><span class="p">,</span> 
<span class="s">"Planning Sample"</span><span class="p">,</span> <span class="s">"CreateSubset"</span><span class="p">,</span> <span class="s">"plan_version"</span><span class="p">,</span> <span class="s">"TITest"</span>
<span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">Handler</span><span class="p">:</span>
<span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span>

    <span class="c1">'Use the message suppressor to turn off all Cognos Office messages.</span>
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>

    <span class="k">Dim</span> <span class="nv">s</span> <span class="ow">As</span> <span class="kt">String</span>

    <span class="k">If</span> <span class="k">Not</span> <span class="n">IsMissing</span><span class="p">(</span><span class="n">arg1</span><span class="p">)</span> <span class="k">Then</span> <span class="n">s</span> <span class="o">=</span> <span class="n">arg1</span>
    <span class="k">If</span> <span class="k">Not</span> <span class="n">IsMissing</span><span class="p">(</span><span class="n">arg2</span><span class="p">)</span> <span class="k">Then</span> <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">arg2</span>
    <span class="k">If</span> <span class="k">Not</span> <span class="n">IsMissing</span><span class="p">(</span><span class="n">arg3</span><span class="p">)</span> <span class="k">Then</span> <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">arg3</span>
    <span class="k">If</span> <span class="k">Not</span> <span class="n">IsMissing</span><span class="p">(</span><span class="n">arg4</span><span class="p">)</span> <span class="k">Then</span> <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">arg4</span>

    <span class="c1">'Call the Cognos Office Automation object to refresh the data.</span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">ExecuteFunction</span> <span class="n">host</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> 
    <span class="n">processName</span><span class="p">,</span> <span class="n">s</span>

    <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">End</span> <span class="k">Sub</span>
</code></pre></div>
<blockquote>
<p>Note
You can specify multiple TI process parameters by separating them with commas.</p>
</blockquote>

<p>ExecuteFunction is a method used to execute a specified TurboIntegrator (TI) process from your report.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the Create method.</p>

<p><code>CognosOfficeAutomationObject.ExecuteFunction(&lt;data source URL&gt;, &lt;server name&gt;, &lt;TI process name&gt;, &lt;Optional TI process parameter&gt;)</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>datasource URL</td>
<td>URL of the host system which the Custom Report is to be created from.</td>
<td>String</td>
</tr>
<tr>
<td>server name</td>
<td>Name of the server which the Custom Report is to be created from.</td>
<td>String</td>
</tr>
<tr>
<td>TI process name</td>
<td>Name of the cube which the Custom Report is to be created from.</td>
<td>String</td>
</tr>
<tr>
<td>Optional TI process parameter</td>
<td>Name of the view which the Custom Report is to be created from.</td>
<td>String array</td>
</tr>
</tbody></table>

<aside class="notice">
You can include an array of TI process parameters by separating them with commas.
</aside>
<h1 id='rest-api'>REST API</h1>
<p>You can use REST APIs to communicate with the TM1 Server.</p>

<p>Before you begin, make sure that you&#39;ve returned the connection object. The connection object will allow you to implement the REST request methods (GET, POST, DELETE, PATCH) and communicate with the TM1 Server.</p>

<p>To learn more about the connection object, see <a href="#getconnection">GetConnection</a>.</p>
<h2 id='get-requests'>GET requests</h2>
<blockquote>
<p>Example of how you can use a <code>GET</code> request in a VBA module to return a JSON object.</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">OData</span><span class="p">(</span><span class="n">Server</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'OData endpoint</span>
    <span class="n">OData</span> <span class="o">=</span> <span class="s">"tm1/"</span> <span class="o">+</span> <span class="n">Server</span> <span class="o">+</span> <span class="s">"/api/v1"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Current</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">Current</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruServer"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetCurrentServer</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCubeMRU</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCube</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="k">Dim</span> <span class="nv">sServer</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruPackage"</span><span class="p">)</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
   <span class="n">sServerCube</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
   <span class="n">sServer</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCube</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">":"</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">GetCurrentServer</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServer</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">oDataGet</span><span class="p">(</span><span class="n">path</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">JSONObjectWrapper</span>
    <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">JSONParser</span>
    <span class="k">Dim</span> <span class="nv">response</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Set</span> <span class="n">response</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetConnection</span><span class="p">(</span><span class="n">Current</span><span class="p">).</span><span class="n">Get</span><span class="p">(</span><span class="n">OData</span><span class="p">(</span><span class="n">GetCurrentServer</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">"/"</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre></div>
<p>Use <code>GET</code> requests to return data from the TM1 Server.</p>
<h3 id='syntax'>Syntax</h3>
<p>The following string is the syntax for the <code>GET</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).Get(&lt;PATH&gt;)</code></p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you are using the GET request on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path that you are using the GET request on.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='post-requests'>POST requests</h2>
<blockquote>
<p>Example of how you can use a <code>POST</code> request in a VBA module to update a component.</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">HubEndpoint</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'Endpoint that CAFE connects to</span>
    <span class="n">HubEndpoint</span> <span class="o">=</span> <span class="s">"pmhub/pm/tm1/"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">OData</span><span class="p">(</span><span class="n">Server</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'OData endpoint</span>
    <span class="n">OData</span> <span class="o">=</span> <span class="s">"tm1/"</span> <span class="o">+</span> <span class="n">Server</span> <span class="o">+</span> <span class="s">"/api/v1"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Current</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">Current</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruServer"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetCurrentServer</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCubeMRU</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCube</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="k">Dim</span> <span class="nv">sServer</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruPackage"</span><span class="p">)</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
   <span class="n">sServerCube</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
   <span class="n">sServer</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCube</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">":"</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>

   <span class="n">GetCurrentServer</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServer</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">oDataPost</span><span class="p">(</span><span class="n">path</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">payload</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">JSONObjectWrapper</span>
    <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">JSONParser</span>
    <span class="k">Dim</span> <span class="nv">response</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Set</span> <span class="n">response</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">GetConnection</span><span class="p">(</span><span class="n">Current</span><span class="p">).</span><span class="n">Post</span><span class="p">(</span><span class="n">OData</span><span class="p">(</span><span class="n">GetCurrentServer</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">"/"</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre></div>
<p>Use <code>POST</code> requests to store or update components in the TM1 Server.</p>
<h3 id='syntax-2'>Syntax</h3>
<p>The following string is the syntax for the <code>POST</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).Post(&lt;PATH&gt;, &lt;PAYLOAD&gt;)</code></p>
<h3 id='arguments-2'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to store or update on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to store to or update.</td>
<td>String</td>
</tr>
<tr>
<td>PAYLOAD</td>
<td>The JSON payload that you are storing or updating to the TM1 Server.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='delete-requests'>DELETE requests</h2>
<blockquote>
<p>Example of how you can use a <code>DELETE</code> request in a VBA module to delete data.</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">HubEndpoint</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'Endpoint that CAFE connects to</span>
    <span class="n">HubEndpoint</span> <span class="o">=</span> <span class="s">"pmhub/pm/tm1/"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">OData</span><span class="p">(</span><span class="n">Server</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">'OData endpoint</span>
    <span class="n">OData</span> <span class="o">=</span> <span class="s">"tm1/"</span> <span class="o">+</span> <span class="n">Server</span> <span class="o">+</span> <span class="s">"/api/v1"</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Current</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">Current</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruServer"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Property</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">GetCurrentServer</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCubeMRU</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">sServerCube</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="k">Dim</span> <span class="nv">sServer</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Reporting</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">"MruPackage"</span><span class="p">)</span>
   <span class="n">sServerCubeMRU</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
   <span class="n">sServerCube</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCubeMRU</span><span class="p">,</span> <span class="s">","</span><span class="p">)</span>
   <span class="n">sServer</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">sServerCube</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s">":"</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>

   <span class="n">GetCurrentServer</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">sServer</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Len</span><span class="p">(</span><span class="n">sServer</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Public</span> <span class="k">Function</span> <span class="nf">oDataDelete</span><span class="p">(</span><span class="n">path</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="n">JSONObjectWrapper</span>
    <span class="k">Dim</span> <span class="nv">result</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">JSONParser</span>
    <span class="k">Dim</span> <span class="nv">response</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="n">Reporting</span><span class="p">.</span><span class="n">GetConnection</span><span class="p">(</span><span class="n">Current</span><span class="p">).</span><span class="n">Delete</span><span class="p">(</span><span class="n">OData</span><span class="p">(</span><span class="n">GetCurrentServer</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">"/"</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre></div>
<p>Use <code>DELETE</code> requests to delete components or data in the TM1 Server.</p>
<h3 id='syntax-3'>Syntax</h3>
<p>The following string is the syntax for the <code>DELETE</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).Delete(&lt;PATH&gt;)</code></p>
<h3 id='arguments-3'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to delete.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to delete.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='patch-requests'>PATCH requests</h2>
<p>Use <code>PATCH</code> requests to update components in the TM1 Server at a target location.</p>
<h3 id='syntax-4'>Syntax</h3>
<p>The following string is the syntax for the <code>PATCH</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).PATCH(&lt;PATH&gt;, &lt;PAYLOAD&gt;)</code></p>
<h3 id='arguments-4'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to update on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to update.</td>
<td>String</td>
</tr>
<tr>
<td>PAYLOAD</td>
<td>The JSON payload that you are storing in the TM1 Server.</td>
<td>String</td>
</tr>
</tbody></table>
<h2 id='put-requests'>PUT requests</h2>
<p>Use <code>PUT</code> requests to place components in the TM1 Server at a target location.</p>
<h3 id='syntax-5'>Syntax</h3>
<p>The following string is the syntax for the <code>PUT</code> request.</p>

<p><code>Reporting.GetConnection(&lt;CURRENT&gt;).PUT(&lt;PATH&gt;, &lt;PAYLOAD&gt;)</code></p>
<h3 id='arguments-5'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
<th>Data type</th>
</tr>
</thead><tbody>
<tr>
<td>CURRENT</td>
<td>The URL of the host that you want to update on.</td>
<td>String</td>
</tr>
<tr>
<td>PATH</td>
<td>The full (absolute) path of the component that you want to place.</td>
<td>String</td>
</tr>
<tr>
<td>PAYLOAD</td>
<td>The JSON payload that you are storing in the TM1 Server.</td>
<td>String</td>
</tr>
</tbody></table>
<h1 id='script-files'>Script files</h1>
<p>The installation includes sample script files that you can use to automate functions. The samples include script files for scheduling the refresh of documents. Also, there is a script file to update the server URL.</p>

<p>You must modify the script files to meet your particular needs or use them as a reference to create your own programs. For more information, see the comments in the file.</p>

<p>These Visual Basic Scripts (VBS) are provided as sample programs and are located in installation_directory\Automation:</p>

<ul>
<li>Automate_COI.vbs</li>
<li>Automate_COI_Excel.vbs</li>
<li>AutomateServerURLSample.vbs</li>
</ul>
<h1 id='macro-files'>Macro files</h1>
<p>The macro files for Cognos® Office are written in Microsoft Visual Basic for Applications (VBA).</p>

<p>The files are installed with IBM® Cognos Office in the automation folder. The default location is <code>[installation_directory]\Automation</code>.</p>
<h3 id='macros'>Macros</h3>
<p>The following macro files are installed.</p>

<table><thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CognosOfficeAutomationExample.bas</td>
<td>Because it is a BASIC file created using VBA, this file has the extension .bas. It contains the <code>CognosOfficeAutomationObject</code> property that enables IBM Cognos Office automation in the current document. It also contains wrapper functions that call the API exposed by IBM Cognos Office.</td>
</tr>
<tr>
<td>CognosOfficeMessageSuppressor.cls</td>
<td>This file shows how to use the <a href="#suppressmessages">SuppressMessages</a> API function.</td>
</tr>
</tbody></table>
<h1 id='examples-of-processing'>Examples of processing</h1><h2 id='processing-outside-of-vba'>Processing outside of VBA</h2>
<blockquote>
<p>The following Visual Basic Script opens Microsoft Office Excel, logs on to IBM Cognos Analytics, refreshes the content, and logs off.</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="c1">' Start Excel in batch mode</span>

<span class="k">Set</span> <span class="n">objExcel</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">)</span>

<span class="n">objExcel</span><span class="p">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="k">False</span>

<span class="n">objExcel</span><span class="p">.</span><span class="n">ScreenUpdating</span> <span class="o">=</span> <span class="k">False</span>

<span class="n">objExcel</span><span class="p">.</span><span class="n">DisplayAlerts</span> <span class="o">=</span> <span class="k">False</span>

<span class="c1">'Open a workbook that has IBM Cognos data</span>
<span class="n">in</span> <span class="n">it</span><span class="p">.</span>

<span class="n">Set</span> <span class="n">objWorkbook</span> <span class="o">=</span> <span class="n">objExcel</span><span class="p">.</span><span class="n">Workbooks</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="s">"C:\workbook1.xls"</span><span class="p">)</span>

<span class="c1">' Call the wrapper macros</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span>
<span class="s">"Administrator"</span><span class="p">,</span> <span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>

<span class="n">objExcel</span><span class="p">.</span><span class="n">Run</span> <span class="s">"RefreshAllData"</span>

<span class="n">objExcel</span><span class="p">.</span><span class="n">Run</span> <span class="s">"Logoff"</span>

<span class="n">objExcel</span><span class="p">.</span><span class="n">Run</span> <span class="s">"TraceLog"</span><span class="p">,</span> <span class="s">"C:\AutomationLog.log"</span>

<span class="n">objWorkbook</span><span class="p">.</span><span class="n">Save</span>

<span class="n">objWorkbook</span><span class="p">.</span><span class="n">Close</span>

<span class="n">objExcel</span><span class="p">.</span><span class="n">Quit</span>
</code></pre></div>
<p>If you want to use IBM® Cognos® Office Automation outside VBA, you cannot call the APIs directly. This topic describes how you can call the APIs outside of VBA.</p>

<p>To use IBM Cognos Office Automation outside VBA, you must create wrapper macros in the Microsoft Office document for each API. You can then call these macros from your code. The module CognosOfficeAutomationExample.bas is an example of a wrapper macro that you can call from outside VBA.</p>

<p>Although Planning Analytics for Microsoft Excel supports processing outside of VBA, it is not recommended due to certain environmental constraints. If you need to process outside of VBA, you should start with using the sample files. Processing outside of VBA will require you to make self-service changes and have the system knowledge required to allow for complex usage scenarios.</p>
<h2 id='processing-within-vba'>Processing within VBA</h2>
<blockquote>
<p>The following example demonstrates how to call the Logon method within VBA</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">bResult</span> <span class="n">as</span> <span class="kt">Boolean</span>

<span class="n">bResult</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logon</span>
<span class="p">(</span><span class="s">"http://localhost/ibmcognos/cgi-bin/cognos.cgi"</span><span class="p">,</span><span class="s">"Administrator"</span><span class="p">,</span>
<span class="s">"CognosAdmin"</span><span class="p">,</span> <span class="s">"Production"</span><span class="p">)</span>

<span class="k">If</span> <span class="n">bResult</span> <span class="k">Then</span>

    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">ClearAllData</span><span class="p">()</span>

    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">RefreshAllData</span><span class="p">()</span>

    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">Logoff</span><span class="p">()</span>

    <span class="k">Dim</span> <span class="nv">sTraceLog</span> <span class="n">as</span> <span class="kt">String</span> 

    <span class="n">sTraceLog</span> <span class="o">=</span> <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">TraceLog</span>

    <span class="c1">'Here is where you could write the trace log to file.</span>

    <span class="n">MsgBox</span> <span class="n">sTraceLog</span>

<span class="k">End</span> <span class="k">If</span>
</code></pre></div><h2 id='troubleshooting-issues'>Troubleshooting issues</h2>
<p>You may encounter issues when processing outside of VBA. This section outlines a few commong issues.</p>
<h3 id='the-script-runs-but-nothing-happens'>The script runs, but nothing happens</h3>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="c1">' This example is placed in the CognosOfficeAutomationExample.bas file</span>

<span class="k">Public</span> <span class="k">Sub</span> <span class="nf">ClearAllData</span><span class="p">()</span>
<span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="n">HANDLER</span><span class="p">:</span>
<span class="k">Dim</span> <span class="nv">oMessageSuppressor</span> <span class="ow">As</span> <span class="n">CognosOfficeMessageSuppressor</span>

    <span class="c1">'Use the message suppressor to turn off all Cognos Office messages.</span>
    <span class="k">Set</span> <span class="n">oMessageSuppressor</span> <span class="o">=</span> <span class="k">New</span> <span class="n">CognosOfficeMessageSuppressor</span>

    <span class="k">Dim</span> <span class="nv">test</span> <span class="ow">As</span> <span class="kt">Object</span>
    <span class="k">Set</span> <span class="n">test</span> <span class="o">=</span> <span class="n">Reporting</span>

    <span class="c1">'Call the Cognos Office Automation object to clear the data.</span>
    <span class="n">CognosOfficeAutomationObject</span><span class="p">.</span><span class="n">ClearAllData</span>

    <span class="k">Exit</span> <span class="k">Sub</span>
<span class="nf">HANDLER</span><span class="p">:</span>
    <span class="c1">'&lt;Place error handling here. You may not want to display a message box if you are running in a scheduled task&gt;</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div>
<p>If your script runs, but nothing happens, it may be a sign that the Planning Analytics for Microsoft Excel add-in is not activated. If the add-in is not activated, Microsoft Excel will not know when and where to execute the Planning Analytics for Microsoft Excel APIs.</p>

<p>You can activate the Planning Analytics for Microsoft Excel manually by opening the IBM Planning Analytics tab:</p>

<ol>
<li>Launch Microsoft Excel.</li>
<li>Click the IBM Planning Analytics tab.</li>
</ol>

<p>You can also activate the Planning Analytics for Microsoft Excel by adding the following lines before a macro call:</p>

<p><code>Dim test As Object</code></p>

<p><code>Set test = Reporting</code></p>
<h3 id='application-crashes-on-when-script-is-running'>Application crashes on when script is running</h3>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="c1">' This example is placed in the Automate_COI.vbs file</span>

<span class="k">Dim</span> <span class="nv">bSuccess</span>
<span class="k">Dim</span> <span class="nv">objExcel</span>
<span class="k">Dim</span> <span class="nv">objWB</span>

<span class="k">Set</span> <span class="n">objExcel</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"Excel.Application"</span><span class="p">)</span>

    <span class="k">If</span> <span class="n">objExcel</span> <span class="ow">Is</span> <span class="k">Nothing</span> <span class="k">Then</span> <span class="n">WScript</span><span class="p">.</span><span class="n">Quit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="err">`</span><span class="n">Turn</span> <span class="n">off</span> <span class="n">Excel</span> <span class="n">features</span><span class="p">.</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">ScreenUpdating</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">objExcel</span><span class="p">.</span><span class="n">DisplayAlerts</span> <span class="o">=</span> <span class="k">False</span>

</code></pre></div>
<p>If the application crashes when you run your script, you may need to check the Microsoft Excel events before you call the Planning Analytics for Microsoft Excel APIs. </p>

<p>To check the Microsoft Excel events, add the following lines to your VBS or VBA file:</p>

<p><code>objExcel.Visible = False</code></p>

<p><code>objExcel.ScreenUpdating = False</code></p>

<p><code>objExcel.DisplayAlerts = False</code></p>

<p>You may also need to add a sleep event before calling the Planning Analytics for Microsoft Excel API. </p>

<p>Example of a sleep event: </p>

<p><code>WScript 5000</code></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="vb">vb</a>
          </div>
      </div>
    </div>
  </body>
</html>
